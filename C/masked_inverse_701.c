
uint16_t cube_shuffle_1[NTRU_N] = {0, 3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36, 39, 42, 45, 48, 51, 54, 57, 60, 63, 66, 69, 72, 75, 78, 81, 84, 87, 90, 93, 96, 99, 102, 105, 108, 111, 114, 117, 120, 123, 126, 129, 132, 135, 138, 141, 144, 147, 150, 153, 156, 159, 162, 165, 168, 171, 174, 177, 180, 183, 186, 189, 192, 195, 198, 201, 204, 207, 210, 213, 216, 219, 222, 225, 228, 231, 234, 237, 240, 243, 246, 249, 252, 255, 258, 261, 264, 267, 270, 273, 276, 279, 282, 285, 288, 291, 294, 297, 300, 303, 306, 309, 312, 315, 318, 321, 324, 327, 330, 333, 336, 339, 342, 345, 348, 351, 354, 357, 360, 363, 366, 369, 372, 375, 378, 381, 384, 387, 390, 393, 396, 399, 402, 405, 408, 411, 414, 417, 420, 423, 426, 429, 432, 435, 438, 441, 444, 447, 450, 453, 456, 459, 462, 465, 468, 471, 474, 477, 480, 483, 486, 489, 492, 495, 498, 501, 504, 507, 510, 513, 516, 519, 522, 525, 528, 531, 534, 537, 540, 543, 546, 549, 552, 555, 558, 561, 564, 567, 570, 573, 576, 579, 582, 585, 588, 591, 594, 597, 600, 603, 606, 609, 612, 615, 618, 621, 624, 627, 630, 633, 636, 639, 642, 645, 648, 651, 654, 657, 660, 663, 666, 669, 672, 675, 678, 681, 684, 687, 690, 693, 696, 699, 1, 4, 7, 10, 13, 16, 19, 22, 25, 28, 31, 34, 37, 40, 43, 46, 49, 52, 55, 58, 61, 64, 67, 70, 73, 76, 79, 82, 85, 88, 91, 94, 97, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 175, 178, 181, 184, 187, 190, 193, 196, 199, 202, 205, 208, 211, 214, 217, 220, 223, 226, 229, 232, 235, 238, 241, 244, 247, 250, 253, 256, 259, 262, 265, 268, 271, 274, 277, 280, 283, 286, 289, 292, 295, 298, 301, 304, 307, 310, 313, 316, 319, 322, 325, 328, 331, 334, 337, 340, 343, 346, 349, 352, 355, 358, 361, 364, 367, 370, 373, 376, 379, 382, 385, 388, 391, 394, 397, 400, 403, 406, 409, 412, 415, 418, 421, 424, 427, 430, 433, 436, 439, 442, 445, 448, 451, 454, 457, 460, 463, 466, 469, 472, 475, 478, 481, 484, 487, 490, 493, 496, 499, 502, 505, 508, 511, 514, 517, 520, 523, 526, 529, 532, 535, 538, 541, 544, 547, 550, 553, 556, 559, 562, 565, 568, 571, 574, 577, 580, 583, 586, 589, 592, 595, 598, 601, 604, 607, 610, 613, 616, 619, 622, 625, 628, 631, 634, 637, 640, 643, 646, 649, 652, 655, 658, 661, 664, 667, 670, 673, 676, 679, 682, 685, 688, 691, 694, 697, 700, 2, 5, 8, 11, 14, 17, 20, 23, 26, 29, 32, 35, 38, 41, 44, 47, 50, 53, 56, 59, 62, 65, 68, 71, 74, 77, 80, 83, 86, 89, 92, 95, 98, 101, 104, 107, 110, 113, 116, 119, 122, 125, 128, 131, 134, 137, 140, 143, 146, 149, 152, 155, 158, 161, 164, 167, 170, 173, 176, 179, 182, 185, 188, 191, 194, 197, 200, 203, 206, 209, 212, 215, 218, 221, 224, 227, 230, 233, 236, 239, 242, 245, 248, 251, 254, 257, 260, 263, 266, 269, 272, 275, 278, 281, 284, 287, 290, 293, 296, 299, 302, 305, 308, 311, 314, 317, 320, 323, 326, 329, 332, 335, 338, 341, 344, 347, 350, 353, 356, 359, 362, 365, 368, 371, 374, 377, 380, 383, 386, 389, 392, 395, 398, 401, 404, 407, 410, 413, 416, 419, 422, 425, 428, 431, 434, 437, 440, 443, 446, 449, 452, 455, 458, 461, 464, 467, 470, 473, 476, 479, 482, 485, 488, 491, 494, 497, 500, 503, 506, 509, 512, 515, 518, 521, 524, 527, 530, 533, 536, 539, 542, 545, 548, 551, 554, 557, 560, 563, 566, 569, 572, 575, 578, 581, 584, 587, 590, 593, 596, 599, 602, 605, 608, 611, 614, 617, 620, 623, 626, 629, 632, 635, 638, 641, 644, 647, 650, 653, 656, 659, 662, 665, 668, 671, 674, 677, 680, 683, 686, 689, 692, 695, 698};
uint16_t cube_shuffle_3[NTRU_N] = {0, 27, 54, 81, 108, 135, 162, 189, 216, 243, 270, 297, 324, 351, 378, 405, 432, 459, 486, 513, 540, 567, 594, 621, 648, 675, 1, 28, 55, 82, 109, 136, 163, 190, 217, 244, 271, 298, 325, 352, 379, 406, 433, 460, 487, 514, 541, 568, 595, 622, 649, 676, 2, 29, 56, 83, 110, 137, 164, 191, 218, 245, 272, 299, 326, 353, 380, 407, 434, 461, 488, 515, 542, 569, 596, 623, 650, 677, 3, 30, 57, 84, 111, 138, 165, 192, 219, 246, 273, 300, 327, 354, 381, 408, 435, 462, 489, 516, 543, 570, 597, 624, 651, 678, 4, 31, 58, 85, 112, 139, 166, 193, 220, 247, 274, 301, 328, 355, 382, 409, 436, 463, 490, 517, 544, 571, 598, 625, 652, 679, 5, 32, 59, 86, 113, 140, 167, 194, 221, 248, 275, 302, 329, 356, 383, 410, 437, 464, 491, 518, 545, 572, 599, 626, 653, 680, 6, 33, 60, 87, 114, 141, 168, 195, 222, 249, 276, 303, 330, 357, 384, 411, 438, 465, 492, 519, 546, 573, 600, 627, 654, 681, 7, 34, 61, 88, 115, 142, 169, 196, 223, 250, 277, 304, 331, 358, 385, 412, 439, 466, 493, 520, 547, 574, 601, 628, 655, 682, 8, 35, 62, 89, 116, 143, 170, 197, 224, 251, 278, 305, 332, 359, 386, 413, 440, 467, 494, 521, 548, 575, 602, 629, 656, 683, 9, 36, 63, 90, 117, 144, 171, 198, 225, 252, 279, 306, 333, 360, 387, 414, 441, 468, 495, 522, 549, 576, 603, 630, 657, 684, 10, 37, 64, 91, 118, 145, 172, 199, 226, 253, 280, 307, 334, 361, 388, 415, 442, 469, 496, 523, 550, 577, 604, 631, 658, 685, 11, 38, 65, 92, 119, 146, 173, 200, 227, 254, 281, 308, 335, 362, 389, 416, 443, 470, 497, 524, 551, 578, 605, 632, 659, 686, 12, 39, 66, 93, 120, 147, 174, 201, 228, 255, 282, 309, 336, 363, 390, 417, 444, 471, 498, 525, 552, 579, 606, 633, 660, 687, 13, 40, 67, 94, 121, 148, 175, 202, 229, 256, 283, 310, 337, 364, 391, 418, 445, 472, 499, 526, 553, 580, 607, 634, 661, 688, 14, 41, 68, 95, 122, 149, 176, 203, 230, 257, 284, 311, 338, 365, 392, 419, 446, 473, 500, 527, 554, 581, 608, 635, 662, 689, 15, 42, 69, 96, 123, 150, 177, 204, 231, 258, 285, 312, 339, 366, 393, 420, 447, 474, 501, 528, 555, 582, 609, 636, 663, 690, 16, 43, 70, 97, 124, 151, 178, 205, 232, 259, 286, 313, 340, 367, 394, 421, 448, 475, 502, 529, 556, 583, 610, 637, 664, 691, 17, 44, 71, 98, 125, 152, 179, 206, 233, 260, 287, 314, 341, 368, 395, 422, 449, 476, 503, 530, 557, 584, 611, 638, 665, 692, 18, 45, 72, 99, 126, 153, 180, 207, 234, 261, 288, 315, 342, 369, 396, 423, 450, 477, 504, 531, 558, 585, 612, 639, 666, 693, 19, 46, 73, 100, 127, 154, 181, 208, 235, 262, 289, 316, 343, 370, 397, 424, 451, 478, 505, 532, 559, 586, 613, 640, 667, 694, 20, 47, 74, 101, 128, 155, 182, 209, 236, 263, 290, 317, 344, 371, 398, 425, 452, 479, 506, 533, 560, 587, 614, 641, 668, 695, 21, 48, 75, 102, 129, 156, 183, 210, 237, 264, 291, 318, 345, 372, 399, 426, 453, 480, 507, 534, 561, 588, 615, 642, 669, 696, 22, 49, 76, 103, 130, 157, 184, 211, 238, 265, 292, 319, 346, 373, 400, 427, 454, 481, 508, 535, 562, 589, 616, 643, 670, 697, 23, 50, 77, 104, 131, 158, 185, 212, 239, 266, 293, 320, 347, 374, 401, 428, 455, 482, 509, 536, 563, 590, 617, 644, 671, 698, 24, 51, 78, 105, 132, 159, 186, 213, 240, 267, 294, 321, 348, 375, 402, 429, 456, 483, 510, 537, 564, 591, 618, 645, 672, 699, 25, 52, 79, 106, 133, 160, 187, 214, 241, 268, 295, 322, 349, 376, 403, 430, 457, 484, 511, 538, 565, 592, 619, 646, 673, 700, 26, 53, 80, 107, 134, 161, 188, 215, 242, 269, 296, 323, 350, 377, 404, 431, 458, 485, 512, 539, 566, 593, 620, 647, 674};
uint16_t cube_shuffle_6[NTRU_N] = {0, 28, 56, 84, 112, 140, 168, 196, 224, 252, 280, 308, 336, 364, 392, 420, 448, 476, 504, 532, 560, 588, 616, 644, 672, 700, 27, 55, 83, 111, 139, 167, 195, 223, 251, 279, 307, 335, 363, 391, 419, 447, 475, 503, 531, 559, 587, 615, 643, 671, 699, 26, 54, 82, 110, 138, 166, 194, 222, 250, 278, 306, 334, 362, 390, 418, 446, 474, 502, 530, 558, 586, 614, 642, 670, 698, 25, 53, 81, 109, 137, 165, 193, 221, 249, 277, 305, 333, 361, 389, 417, 445, 473, 501, 529, 557, 585, 613, 641, 669, 697, 24, 52, 80, 108, 136, 164, 192, 220, 248, 276, 304, 332, 360, 388, 416, 444, 472, 500, 528, 556, 584, 612, 640, 668, 696, 23, 51, 79, 107, 135, 163, 191, 219, 247, 275, 303, 331, 359, 387, 415, 443, 471, 499, 527, 555, 583, 611, 639, 667, 695, 22, 50, 78, 106, 134, 162, 190, 218, 246, 274, 302, 330, 358, 386, 414, 442, 470, 498, 526, 554, 582, 610, 638, 666, 694, 21, 49, 77, 105, 133, 161, 189, 217, 245, 273, 301, 329, 357, 385, 413, 441, 469, 497, 525, 553, 581, 609, 637, 665, 693, 20, 48, 76, 104, 132, 160, 188, 216, 244, 272, 300, 328, 356, 384, 412, 440, 468, 496, 524, 552, 580, 608, 636, 664, 692, 19, 47, 75, 103, 131, 159, 187, 215, 243, 271, 299, 327, 355, 383, 411, 439, 467, 495, 523, 551, 579, 607, 635, 663, 691, 18, 46, 74, 102, 130, 158, 186, 214, 242, 270, 298, 326, 354, 382, 410, 438, 466, 494, 522, 550, 578, 606, 634, 662, 690, 17, 45, 73, 101, 129, 157, 185, 213, 241, 269, 297, 325, 353, 381, 409, 437, 465, 493, 521, 549, 577, 605, 633, 661, 689, 16, 44, 72, 100, 128, 156, 184, 212, 240, 268, 296, 324, 352, 380, 408, 436, 464, 492, 520, 548, 576, 604, 632, 660, 688, 15, 43, 71, 99, 127, 155, 183, 211, 239, 267, 295, 323, 351, 379, 407, 435, 463, 491, 519, 547, 575, 603, 631, 659, 687, 14, 42, 70, 98, 126, 154, 182, 210, 238, 266, 294, 322, 350, 378, 406, 434, 462, 490, 518, 546, 574, 602, 630, 658, 686, 13, 41, 69, 97, 125, 153, 181, 209, 237, 265, 293, 321, 349, 377, 405, 433, 461, 489, 517, 545, 573, 601, 629, 657, 685, 12, 40, 68, 96, 124, 152, 180, 208, 236, 264, 292, 320, 348, 376, 404, 432, 460, 488, 516, 544, 572, 600, 628, 656, 684, 11, 39, 67, 95, 123, 151, 179, 207, 235, 263, 291, 319, 347, 375, 403, 431, 459, 487, 515, 543, 571, 599, 627, 655, 683, 10, 38, 66, 94, 122, 150, 178, 206, 234, 262, 290, 318, 346, 374, 402, 430, 458, 486, 514, 542, 570, 598, 626, 654, 682, 9, 37, 65, 93, 121, 149, 177, 205, 233, 261, 289, 317, 345, 373, 401, 429, 457, 485, 513, 541, 569, 597, 625, 653, 681, 8, 36, 64, 92, 120, 148, 176, 204, 232, 260, 288, 316, 344, 372, 400, 428, 456, 484, 512, 540, 568, 596, 624, 652, 680, 7, 35, 63, 91, 119, 147, 175, 203, 231, 259, 287, 315, 343, 371, 399, 427, 455, 483, 511, 539, 567, 595, 623, 651, 679, 6, 34, 62, 90, 118, 146, 174, 202, 230, 258, 286, 314, 342, 370, 398, 426, 454, 482, 510, 538, 566, 594, 622, 650, 678, 5, 33, 61, 89, 117, 145, 173, 201, 229, 257, 285, 313, 341, 369, 397, 425, 453, 481, 509, 537, 565, 593, 621, 649, 677, 4, 32, 60, 88, 116, 144, 172, 200, 228, 256, 284, 312, 340, 368, 396, 424, 452, 480, 508, 536, 564, 592, 620, 648, 676, 3, 31, 59, 87, 115, 143, 171, 199, 227, 255, 283, 311, 339, 367, 395, 423, 451, 479, 507, 535, 563, 591, 619, 647, 675, 2, 30, 58, 86, 114, 142, 170, 198, 226, 254, 282, 310, 338, 366, 394, 422, 450, 478, 506, 534, 562, 590, 618, 646, 674, 1, 29, 57, 85, 113, 141, 169, 197, 225, 253, 281, 309, 337, 365, 393, 421, 449, 477, 505, 533, 561, 589, 617, 645, 673};
uint16_t cube_shuffle_12[NTRU_N] = {0, 83, 166, 249, 332, 415, 498, 581, 664, 46, 129, 212, 295, 378, 461, 544, 627, 9, 92, 175, 258, 341, 424, 507, 590, 673, 55, 138, 221, 304, 387, 470, 553, 636, 18, 101, 184, 267, 350, 433, 516, 599, 682, 64, 147, 230, 313, 396, 479, 562, 645, 27, 110, 193, 276, 359, 442, 525, 608, 691, 73, 156, 239, 322, 405, 488, 571, 654, 36, 119, 202, 285, 368, 451, 534, 617, 700, 82, 165, 248, 331, 414, 497, 580, 663, 45, 128, 211, 294, 377, 460, 543, 626, 8, 91, 174, 257, 340, 423, 506, 589, 672, 54, 137, 220, 303, 386, 469, 552, 635, 17, 100, 183, 266, 349, 432, 515, 598, 681, 63, 146, 229, 312, 395, 478, 561, 644, 26, 109, 192, 275, 358, 441, 524, 607, 690, 72, 155, 238, 321, 404, 487, 570, 653, 35, 118, 201, 284, 367, 450, 533, 616, 699, 81, 164, 247, 330, 413, 496, 579, 662, 44, 127, 210, 293, 376, 459, 542, 625, 7, 90, 173, 256, 339, 422, 505, 588, 671, 53, 136, 219, 302, 385, 468, 551, 634, 16, 99, 182, 265, 348, 431, 514, 597, 680, 62, 145, 228, 311, 394, 477, 560, 643, 25, 108, 191, 274, 357, 440, 523, 606, 689, 71, 154, 237, 320, 403, 486, 569, 652, 34, 117, 200, 283, 366, 449, 532, 615, 698, 80, 163, 246, 329, 412, 495, 578, 661, 43, 126, 209, 292, 375, 458, 541, 624, 6, 89, 172, 255, 338, 421, 504, 587, 670, 52, 135, 218, 301, 384, 467, 550, 633, 15, 98, 181, 264, 347, 430, 513, 596, 679, 61, 144, 227, 310, 393, 476, 559, 642, 24, 107, 190, 273, 356, 439, 522, 605, 688, 70, 153, 236, 319, 402, 485, 568, 651, 33, 116, 199, 282, 365, 448, 531, 614, 697, 79, 162, 245, 328, 411, 494, 577, 660, 42, 125, 208, 291, 374, 457, 540, 623, 5, 88, 171, 254, 337, 420, 503, 586, 669, 51, 134, 217, 300, 383, 466, 549, 632, 14, 97, 180, 263, 346, 429, 512, 595, 678, 60, 143, 226, 309, 392, 475, 558, 641, 23, 106, 189, 272, 355, 438, 521, 604, 687, 69, 152, 235, 318, 401, 484, 567, 650, 32, 115, 198, 281, 364, 447, 530, 613, 696, 78, 161, 244, 327, 410, 493, 576, 659, 41, 124, 207, 290, 373, 456, 539, 622, 4, 87, 170, 253, 336, 419, 502, 585, 668, 50, 133, 216, 299, 382, 465, 548, 631, 13, 96, 179, 262, 345, 428, 511, 594, 677, 59, 142, 225, 308, 391, 474, 557, 640, 22, 105, 188, 271, 354, 437, 520, 603, 686, 68, 151, 234, 317, 400, 483, 566, 649, 31, 114, 197, 280, 363, 446, 529, 612, 695, 77, 160, 243, 326, 409, 492, 575, 658, 40, 123, 206, 289, 372, 455, 538, 621, 3, 86, 169, 252, 335, 418, 501, 584, 667, 49, 132, 215, 298, 381, 464, 547, 630, 12, 95, 178, 261, 344, 427, 510, 593, 676, 58, 141, 224, 307, 390, 473, 556, 639, 21, 104, 187, 270, 353, 436, 519, 602, 685, 67, 150, 233, 316, 399, 482, 565, 648, 30, 113, 196, 279, 362, 445, 528, 611, 694, 76, 159, 242, 325, 408, 491, 574, 657, 39, 122, 205, 288, 371, 454, 537, 620, 2, 85, 168, 251, 334, 417, 500, 583, 666, 48, 131, 214, 297, 380, 463, 546, 629, 11, 94, 177, 260, 343, 426, 509, 592, 675, 57, 140, 223, 306, 389, 472, 555, 638, 20, 103, 186, 269, 352, 435, 518, 601, 684, 66, 149, 232, 315, 398, 481, 564, 647, 29, 112, 195, 278, 361, 444, 527, 610, 693, 75, 158, 241, 324, 407, 490, 573, 656, 38, 121, 204, 287, 370, 453, 536, 619, 1, 84, 167, 250, 333, 416, 499, 582, 665, 47, 130, 213, 296, 379, 462, 545, 628, 10, 93, 176, 259, 342, 425, 508, 591, 674, 56, 139, 222, 305, 388, 471, 554, 637, 19, 102, 185, 268, 351, 434, 517, 600, 683, 65, 148, 231, 314, 397, 480, 563, 646, 28, 111, 194, 277, 360, 443, 526, 609, 692, 74, 157, 240, 323, 406, 489, 572, 655, 37, 120, 203, 286, 369, 452, 535, 618};
uint16_t cube_shuffle_15[NTRU_N] = {0, 138, 276, 414, 552, 690, 127, 265, 403, 541, 679, 116, 254, 392, 530, 668, 105, 243, 381, 519, 657, 94, 232, 370, 508, 646, 83, 221, 359, 497, 635, 72, 210, 348, 486, 624, 61, 199, 337, 475, 613, 50, 188, 326, 464, 602, 39, 177, 315, 453, 591, 28, 166, 304, 442, 580, 17, 155, 293, 431, 569, 6, 144, 282, 420, 558, 696, 133, 271, 409, 547, 685, 122, 260, 398, 536, 674, 111, 249, 387, 525, 663, 100, 238, 376, 514, 652, 89, 227, 365, 503, 641, 78, 216, 354, 492, 630, 67, 205, 343, 481, 619, 56, 194, 332, 470, 608, 45, 183, 321, 459, 597, 34, 172, 310, 448, 586, 23, 161, 299, 437, 575, 12, 150, 288, 426, 564, 1, 139, 277, 415, 553, 691, 128, 266, 404, 542, 680, 117, 255, 393, 531, 669, 106, 244, 382, 520, 658, 95, 233, 371, 509, 647, 84, 222, 360, 498, 636, 73, 211, 349, 487, 625, 62, 200, 338, 476, 614, 51, 189, 327, 465, 603, 40, 178, 316, 454, 592, 29, 167, 305, 443, 581, 18, 156, 294, 432, 570, 7, 145, 283, 421, 559, 697, 134, 272, 410, 548, 686, 123, 261, 399, 537, 675, 112, 250, 388, 526, 664, 101, 239, 377, 515, 653, 90, 228, 366, 504, 642, 79, 217, 355, 493, 631, 68, 206, 344, 482, 620, 57, 195, 333, 471, 609, 46, 184, 322, 460, 598, 35, 173, 311, 449, 587, 24, 162, 300, 438, 576, 13, 151, 289, 427, 565, 2, 140, 278, 416, 554, 692, 129, 267, 405, 543, 681, 118, 256, 394, 532, 670, 107, 245, 383, 521, 659, 96, 234, 372, 510, 648, 85, 223, 361, 499, 637, 74, 212, 350, 488, 626, 63, 201, 339, 477, 615, 52, 190, 328, 466, 604, 41, 179, 317, 455, 593, 30, 168, 306, 444, 582, 19, 157, 295, 433, 571, 8, 146, 284, 422, 560, 698, 135, 273, 411, 549, 687, 124, 262, 400, 538, 676, 113, 251, 389, 527, 665, 102, 240, 378, 516, 654, 91, 229, 367, 505, 643, 80, 218, 356, 494, 632, 69, 207, 345, 483, 621, 58, 196, 334, 472, 610, 47, 185, 323, 461, 599, 36, 174, 312, 450, 588, 25, 163, 301, 439, 577, 14, 152, 290, 428, 566, 3, 141, 279, 417, 555, 693, 130, 268, 406, 544, 682, 119, 257, 395, 533, 671, 108, 246, 384, 522, 660, 97, 235, 373, 511, 649, 86, 224, 362, 500, 638, 75, 213, 351, 489, 627, 64, 202, 340, 478, 616, 53, 191, 329, 467, 605, 42, 180, 318, 456, 594, 31, 169, 307, 445, 583, 20, 158, 296, 434, 572, 9, 147, 285, 423, 561, 699, 136, 274, 412, 550, 688, 125, 263, 401, 539, 677, 114, 252, 390, 528, 666, 103, 241, 379, 517, 655, 92, 230, 368, 506, 644, 81, 219, 357, 495, 633, 70, 208, 346, 484, 622, 59, 197, 335, 473, 611, 48, 186, 324, 462, 600, 37, 175, 313, 451, 589, 26, 164, 302, 440, 578, 15, 153, 291, 429, 567, 4, 142, 280, 418, 556, 694, 131, 269, 407, 545, 683, 120, 258, 396, 534, 672, 109, 247, 385, 523, 661, 98, 236, 374, 512, 650, 87, 225, 363, 501, 639, 76, 214, 352, 490, 628, 65, 203, 341, 479, 617, 54, 192, 330, 468, 606, 43, 181, 319, 457, 595, 32, 170, 308, 446, 584, 21, 159, 297, 435, 573, 10, 148, 286, 424, 562, 700, 137, 275, 413, 551, 689, 126, 264, 402, 540, 678, 115, 253, 391, 529, 667, 104, 242, 380, 518, 656, 93, 231, 369, 507, 645, 82, 220, 358, 496, 634, 71, 209, 347, 485, 623, 60, 198, 336, 474, 612, 49, 187, 325, 463, 601, 38, 176, 314, 452, 590, 27, 165, 303, 441, 579, 16, 154, 292, 430, 568, 5, 143, 281, 419, 557, 695, 132, 270, 408, 546, 684, 121, 259, 397, 535, 673, 110, 248, 386, 524, 662, 99, 237, 375, 513, 651, 88, 226, 364, 502, 640, 77, 215, 353, 491, 629, 66, 204, 342, 480, 618, 55, 193, 331, 469, 607, 44, 182, 320, 458, 596, 33, 171, 309, 447, 585, 22, 160, 298, 436, 574, 11, 149, 287, 425, 563};
uint16_t cube_shuffle_42[NTRU_N] = {0, 598, 495, 392, 289, 186, 83, 681, 578, 475, 372, 269, 166, 63, 661, 558, 455, 352, 249, 146, 43, 641, 538, 435, 332, 229, 126, 23, 621, 518, 415, 312, 209, 106, 3, 601, 498, 395, 292, 189, 86, 684, 581, 478, 375, 272, 169, 66, 664, 561, 458, 355, 252, 149, 46, 644, 541, 438, 335, 232, 129, 26, 624, 521, 418, 315, 212, 109, 6, 604, 501, 398, 295, 192, 89, 687, 584, 481, 378, 275, 172, 69, 667, 564, 461, 358, 255, 152, 49, 647, 544, 441, 338, 235, 132, 29, 627, 524, 421, 318, 215, 112, 9, 607, 504, 401, 298, 195, 92, 690, 587, 484, 381, 278, 175, 72, 670, 567, 464, 361, 258, 155, 52, 650, 547, 444, 341, 238, 135, 32, 630, 527, 424, 321, 218, 115, 12, 610, 507, 404, 301, 198, 95, 693, 590, 487, 384, 281, 178, 75, 673, 570, 467, 364, 261, 158, 55, 653, 550, 447, 344, 241, 138, 35, 633, 530, 427, 324, 221, 118, 15, 613, 510, 407, 304, 201, 98, 696, 593, 490, 387, 284, 181, 78, 676, 573, 470, 367, 264, 161, 58, 656, 553, 450, 347, 244, 141, 38, 636, 533, 430, 327, 224, 121, 18, 616, 513, 410, 307, 204, 101, 699, 596, 493, 390, 287, 184, 81, 679, 576, 473, 370, 267, 164, 61, 659, 556, 453, 350, 247, 144, 41, 639, 536, 433, 330, 227, 124, 21, 619, 516, 413, 310, 207, 104, 1, 599, 496, 393, 290, 187, 84, 682, 579, 476, 373, 270, 167, 64, 662, 559, 456, 353, 250, 147, 44, 642, 539, 436, 333, 230, 127, 24, 622, 519, 416, 313, 210, 107, 4, 602, 499, 396, 293, 190, 87, 685, 582, 479, 376, 273, 170, 67, 665, 562, 459, 356, 253, 150, 47, 645, 542, 439, 336, 233, 130, 27, 625, 522, 419, 316, 213, 110, 7, 605, 502, 399, 296, 193, 90, 688, 585, 482, 379, 276, 173, 70, 668, 565, 462, 359, 256, 153, 50, 648, 545, 442, 339, 236, 133, 30, 628, 525, 422, 319, 216, 113, 10, 608, 505, 402, 299, 196, 93, 691, 588, 485, 382, 279, 176, 73, 671, 568, 465, 362, 259, 156, 53, 651, 548, 445, 342, 239, 136, 33, 631, 528, 425, 322, 219, 116, 13, 611, 508, 405, 302, 199, 96, 694, 591, 488, 385, 282, 179, 76, 674, 571, 468, 365, 262, 159, 56, 654, 551, 448, 345, 242, 139, 36, 634, 531, 428, 325, 222, 119, 16, 614, 511, 408, 305, 202, 99, 697, 594, 491, 388, 285, 182, 79, 677, 574, 471, 368, 265, 162, 59, 657, 554, 451, 348, 245, 142, 39, 637, 534, 431, 328, 225, 122, 19, 617, 514, 411, 308, 205, 102, 700, 597, 494, 391, 288, 185, 82, 680, 577, 474, 371, 268, 165, 62, 660, 557, 454, 351, 248, 145, 42, 640, 537, 434, 331, 228, 125, 22, 620, 517, 414, 311, 208, 105, 2, 600, 497, 394, 291, 188, 85, 683, 580, 477, 374, 271, 168, 65, 663, 560, 457, 354, 251, 148, 45, 643, 540, 437, 334, 231, 128, 25, 623, 520, 417, 314, 211, 108, 5, 603, 500, 397, 294, 191, 88, 686, 583, 480, 377, 274, 171, 68, 666, 563, 460, 357, 254, 151, 48, 646, 543, 440, 337, 234, 131, 28, 626, 523, 420, 317, 214, 111, 8, 606, 503, 400, 297, 194, 91, 689, 586, 483, 380, 277, 174, 71, 669, 566, 463, 360, 257, 154, 51, 649, 546, 443, 340, 237, 134, 31, 629, 526, 423, 320, 217, 114, 11, 609, 506, 403, 300, 197, 94, 692, 589, 486, 383, 280, 177, 74, 672, 569, 466, 363, 260, 157, 54, 652, 549, 446, 343, 240, 137, 34, 632, 529, 426, 323, 220, 117, 14, 612, 509, 406, 303, 200, 97, 695, 592, 489, 386, 283, 180, 77, 675, 572, 469, 366, 263, 160, 57, 655, 552, 449, 346, 243, 140, 37, 635, 532, 429, 326, 223, 120, 17, 615, 512, 409, 306, 203, 100, 698, 595, 492, 389, 286, 183, 80, 678, 575, 472, 369, 266, 163, 60, 658, 555, 452, 349, 246, 143, 40, 638, 535, 432, 329, 226, 123, 20, 618, 515, 412, 309, 206, 103};
uint16_t cube_shuffle_84[NTRU_N] = {0, 94, 188, 282, 376, 470, 564, 658, 51, 145, 239, 333, 427, 521, 615, 8, 102, 196, 290, 384, 478, 572, 666, 59, 153, 247, 341, 435, 529, 623, 16, 110, 204, 298, 392, 486, 580, 674, 67, 161, 255, 349, 443, 537, 631, 24, 118, 212, 306, 400, 494, 588, 682, 75, 169, 263, 357, 451, 545, 639, 32, 126, 220, 314, 408, 502, 596, 690, 83, 177, 271, 365, 459, 553, 647, 40, 134, 228, 322, 416, 510, 604, 698, 91, 185, 279, 373, 467, 561, 655, 48, 142, 236, 330, 424, 518, 612, 5, 99, 193, 287, 381, 475, 569, 663, 56, 150, 244, 338, 432, 526, 620, 13, 107, 201, 295, 389, 483, 577, 671, 64, 158, 252, 346, 440, 534, 628, 21, 115, 209, 303, 397, 491, 585, 679, 72, 166, 260, 354, 448, 542, 636, 29, 123, 217, 311, 405, 499, 593, 687, 80, 174, 268, 362, 456, 550, 644, 37, 131, 225, 319, 413, 507, 601, 695, 88, 182, 276, 370, 464, 558, 652, 45, 139, 233, 327, 421, 515, 609, 2, 96, 190, 284, 378, 472, 566, 660, 53, 147, 241, 335, 429, 523, 617, 10, 104, 198, 292, 386, 480, 574, 668, 61, 155, 249, 343, 437, 531, 625, 18, 112, 206, 300, 394, 488, 582, 676, 69, 163, 257, 351, 445, 539, 633, 26, 120, 214, 308, 402, 496, 590, 684, 77, 171, 265, 359, 453, 547, 641, 34, 128, 222, 316, 410, 504, 598, 692, 85, 179, 273, 367, 461, 555, 649, 42, 136, 230, 324, 418, 512, 606, 700, 93, 187, 281, 375, 469, 563, 657, 50, 144, 238, 332, 426, 520, 614, 7, 101, 195, 289, 383, 477, 571, 665, 58, 152, 246, 340, 434, 528, 622, 15, 109, 203, 297, 391, 485, 579, 673, 66, 160, 254, 348, 442, 536, 630, 23, 117, 211, 305, 399, 493, 587, 681, 74, 168, 262, 356, 450, 544, 638, 31, 125, 219, 313, 407, 501, 595, 689, 82, 176, 270, 364, 458, 552, 646, 39, 133, 227, 321, 415, 509, 603, 697, 90, 184, 278, 372, 466, 560, 654, 47, 141, 235, 329, 423, 517, 611, 4, 98, 192, 286, 380, 474, 568, 662, 55, 149, 243, 337, 431, 525, 619, 12, 106, 200, 294, 388, 482, 576, 670, 63, 157, 251, 345, 439, 533, 627, 20, 114, 208, 302, 396, 490, 584, 678, 71, 165, 259, 353, 447, 541, 635, 28, 122, 216, 310, 404, 498, 592, 686, 79, 173, 267, 361, 455, 549, 643, 36, 130, 224, 318, 412, 506, 600, 694, 87, 181, 275, 369, 463, 557, 651, 44, 138, 232, 326, 420, 514, 608, 1, 95, 189, 283, 377, 471, 565, 659, 52, 146, 240, 334, 428, 522, 616, 9, 103, 197, 291, 385, 479, 573, 667, 60, 154, 248, 342, 436, 530, 624, 17, 111, 205, 299, 393, 487, 581, 675, 68, 162, 256, 350, 444, 538, 632, 25, 119, 213, 307, 401, 495, 589, 683, 76, 170, 264, 358, 452, 546, 640, 33, 127, 221, 315, 409, 503, 597, 691, 84, 178, 272, 366, 460, 554, 648, 41, 135, 229, 323, 417, 511, 605, 699, 92, 186, 280, 374, 468, 562, 656, 49, 143, 237, 331, 425, 519, 613, 6, 100, 194, 288, 382, 476, 570, 664, 57, 151, 245, 339, 433, 527, 621, 14, 108, 202, 296, 390, 484, 578, 672, 65, 159, 253, 347, 441, 535, 629, 22, 116, 210, 304, 398, 492, 586, 680, 73, 167, 261, 355, 449, 543, 637, 30, 124, 218, 312, 406, 500, 594, 688, 81, 175, 269, 363, 457, 551, 645, 38, 132, 226, 320, 414, 508, 602, 696, 89, 183, 277, 371, 465, 559, 653, 46, 140, 234, 328, 422, 516, 610, 3, 97, 191, 285, 379, 473, 567, 661, 54, 148, 242, 336, 430, 524, 618, 11, 105, 199, 293, 387, 481, 575, 669, 62, 156, 250, 344, 438, 532, 626, 19, 113, 207, 301, 395, 489, 583, 677, 70, 164, 258, 352, 446, 540, 634, 27, 121, 215, 309, 403, 497, 591, 685, 78, 172, 266, 360, 454, 548, 642, 35, 129, 223, 317, 411, 505, 599, 693, 86, 180, 274, 368, 462, 556, 650, 43, 137, 231, 325, 419, 513, 607};
uint16_t cube_shuffle_168[NTRU_N] = {0, 424, 147, 571, 294, 17, 441, 164, 588, 311, 34, 458, 181, 605, 328, 51, 475, 198, 622, 345, 68, 492, 215, 639, 362, 85, 509, 232, 656, 379, 102, 526, 249, 673, 396, 119, 543, 266, 690, 413, 136, 560, 283, 6, 430, 153, 577, 300, 23, 447, 170, 594, 317, 40, 464, 187, 611, 334, 57, 481, 204, 628, 351, 74, 498, 221, 645, 368, 91, 515, 238, 662, 385, 108, 532, 255, 679, 402, 125, 549, 272, 696, 419, 142, 566, 289, 12, 436, 159, 583, 306, 29, 453, 176, 600, 323, 46, 470, 193, 617, 340, 63, 487, 210, 634, 357, 80, 504, 227, 651, 374, 97, 521, 244, 668, 391, 114, 538, 261, 685, 408, 131, 555, 278, 1, 425, 148, 572, 295, 18, 442, 165, 589, 312, 35, 459, 182, 606, 329, 52, 476, 199, 623, 346, 69, 493, 216, 640, 363, 86, 510, 233, 657, 380, 103, 527, 250, 674, 397, 120, 544, 267, 691, 414, 137, 561, 284, 7, 431, 154, 578, 301, 24, 448, 171, 595, 318, 41, 465, 188, 612, 335, 58, 482, 205, 629, 352, 75, 499, 222, 646, 369, 92, 516, 239, 663, 386, 109, 533, 256, 680, 403, 126, 550, 273, 697, 420, 143, 567, 290, 13, 437, 160, 584, 307, 30, 454, 177, 601, 324, 47, 471, 194, 618, 341, 64, 488, 211, 635, 358, 81, 505, 228, 652, 375, 98, 522, 245, 669, 392, 115, 539, 262, 686, 409, 132, 556, 279, 2, 426, 149, 573, 296, 19, 443, 166, 590, 313, 36, 460, 183, 607, 330, 53, 477, 200, 624, 347, 70, 494, 217, 641, 364, 87, 511, 234, 658, 381, 104, 528, 251, 675, 398, 121, 545, 268, 692, 415, 138, 562, 285, 8, 432, 155, 579, 302, 25, 449, 172, 596, 319, 42, 466, 189, 613, 336, 59, 483, 206, 630, 353, 76, 500, 223, 647, 370, 93, 517, 240, 664, 387, 110, 534, 257, 681, 404, 127, 551, 274, 698, 421, 144, 568, 291, 14, 438, 161, 585, 308, 31, 455, 178, 602, 325, 48, 472, 195, 619, 342, 65, 489, 212, 636, 359, 82, 506, 229, 653, 376, 99, 523, 246, 670, 393, 116, 540, 263, 687, 410, 133, 557, 280, 3, 427, 150, 574, 297, 20, 444, 167, 591, 314, 37, 461, 184, 608, 331, 54, 478, 201, 625, 348, 71, 495, 218, 642, 365, 88, 512, 235, 659, 382, 105, 529, 252, 676, 399, 122, 546, 269, 693, 416, 139, 563, 286, 9, 433, 156, 580, 303, 26, 450, 173, 597, 320, 43, 467, 190, 614, 337, 60, 484, 207, 631, 354, 77, 501, 224, 648, 371, 94, 518, 241, 665, 388, 111, 535, 258, 682, 405, 128, 552, 275, 699, 422, 145, 569, 292, 15, 439, 162, 586, 309, 32, 456, 179, 603, 326, 49, 473, 196, 620, 343, 66, 490, 213, 637, 360, 83, 507, 230, 654, 377, 100, 524, 247, 671, 394, 117, 541, 264, 688, 411, 134, 558, 281, 4, 428, 151, 575, 298, 21, 445, 168, 592, 315, 38, 462, 185, 609, 332, 55, 479, 202, 626, 349, 72, 496, 219, 643, 366, 89, 513, 236, 660, 383, 106, 530, 253, 677, 400, 123, 547, 270, 694, 417, 140, 564, 287, 10, 434, 157, 581, 304, 27, 451, 174, 598, 321, 44, 468, 191, 615, 338, 61, 485, 208, 632, 355, 78, 502, 225, 649, 372, 95, 519, 242, 666, 389, 112, 536, 259, 683, 406, 129, 553, 276, 700, 423, 146, 570, 293, 16, 440, 163, 587, 310, 33, 457, 180, 604, 327, 50, 474, 197, 621, 344, 67, 491, 214, 638, 361, 84, 508, 231, 655, 378, 101, 525, 248, 672, 395, 118, 542, 265, 689, 412, 135, 559, 282, 5, 429, 152, 576, 299, 22, 446, 169, 593, 316, 39, 463, 186, 610, 333, 56, 480, 203, 627, 350, 73, 497, 220, 644, 367, 90, 514, 237, 661, 384, 107, 531, 254, 678, 401, 124, 548, 271, 695, 418, 141, 565, 288, 11, 435, 158, 582, 305, 28, 452, 175, 599, 322, 45, 469, 192, 616, 339, 62, 486, 209, 633, 356, 79, 503, 226, 650, 373, 96, 520, 243, 667, 390, 113, 537, 260, 684, 407, 130, 554, 277};
uint16_t cube_shuffle_336[NTRU_N] = {0, 320, 640, 259, 579, 198, 518, 137, 457, 76, 396, 15, 335, 655, 274, 594, 213, 533, 152, 472, 91, 411, 30, 350, 670, 289, 609, 228, 548, 167, 487, 106, 426, 45, 365, 685, 304, 624, 243, 563, 182, 502, 121, 441, 60, 380, 700, 319, 639, 258, 578, 197, 517, 136, 456, 75, 395, 14, 334, 654, 273, 593, 212, 532, 151, 471, 90, 410, 29, 349, 669, 288, 608, 227, 547, 166, 486, 105, 425, 44, 364, 684, 303, 623, 242, 562, 181, 501, 120, 440, 59, 379, 699, 318, 638, 257, 577, 196, 516, 135, 455, 74, 394, 13, 333, 653, 272, 592, 211, 531, 150, 470, 89, 409, 28, 348, 668, 287, 607, 226, 546, 165, 485, 104, 424, 43, 363, 683, 302, 622, 241, 561, 180, 500, 119, 439, 58, 378, 698, 317, 637, 256, 576, 195, 515, 134, 454, 73, 393, 12, 332, 652, 271, 591, 210, 530, 149, 469, 88, 408, 27, 347, 667, 286, 606, 225, 545, 164, 484, 103, 423, 42, 362, 682, 301, 621, 240, 560, 179, 499, 118, 438, 57, 377, 697, 316, 636, 255, 575, 194, 514, 133, 453, 72, 392, 11, 331, 651, 270, 590, 209, 529, 148, 468, 87, 407, 26, 346, 666, 285, 605, 224, 544, 163, 483, 102, 422, 41, 361, 681, 300, 620, 239, 559, 178, 498, 117, 437, 56, 376, 696, 315, 635, 254, 574, 193, 513, 132, 452, 71, 391, 10, 330, 650, 269, 589, 208, 528, 147, 467, 86, 406, 25, 345, 665, 284, 604, 223, 543, 162, 482, 101, 421, 40, 360, 680, 299, 619, 238, 558, 177, 497, 116, 436, 55, 375, 695, 314, 634, 253, 573, 192, 512, 131, 451, 70, 390, 9, 329, 649, 268, 588, 207, 527, 146, 466, 85, 405, 24, 344, 664, 283, 603, 222, 542, 161, 481, 100, 420, 39, 359, 679, 298, 618, 237, 557, 176, 496, 115, 435, 54, 374, 694, 313, 633, 252, 572, 191, 511, 130, 450, 69, 389, 8, 328, 648, 267, 587, 206, 526, 145, 465, 84, 404, 23, 343, 663, 282, 602, 221, 541, 160, 480, 99, 419, 38, 358, 678, 297, 617, 236, 556, 175, 495, 114, 434, 53, 373, 693, 312, 632, 251, 571, 190, 510, 129, 449, 68, 388, 7, 327, 647, 266, 586, 205, 525, 144, 464, 83, 403, 22, 342, 662, 281, 601, 220, 540, 159, 479, 98, 418, 37, 357, 677, 296, 616, 235, 555, 174, 494, 113, 433, 52, 372, 692, 311, 631, 250, 570, 189, 509, 128, 448, 67, 387, 6, 326, 646, 265, 585, 204, 524, 143, 463, 82, 402, 21, 341, 661, 280, 600, 219, 539, 158, 478, 97, 417, 36, 356, 676, 295, 615, 234, 554, 173, 493, 112, 432, 51, 371, 691, 310, 630, 249, 569, 188, 508, 127, 447, 66, 386, 5, 325, 645, 264, 584, 203, 523, 142, 462, 81, 401, 20, 340, 660, 279, 599, 218, 538, 157, 477, 96, 416, 35, 355, 675, 294, 614, 233, 553, 172, 492, 111, 431, 50, 370, 690, 309, 629, 248, 568, 187, 507, 126, 446, 65, 385, 4, 324, 644, 263, 583, 202, 522, 141, 461, 80, 400, 19, 339, 659, 278, 598, 217, 537, 156, 476, 95, 415, 34, 354, 674, 293, 613, 232, 552, 171, 491, 110, 430, 49, 369, 689, 308, 628, 247, 567, 186, 506, 125, 445, 64, 384, 3, 323, 643, 262, 582, 201, 521, 140, 460, 79, 399, 18, 338, 658, 277, 597, 216, 536, 155, 475, 94, 414, 33, 353, 673, 292, 612, 231, 551, 170, 490, 109, 429, 48, 368, 688, 307, 627, 246, 566, 185, 505, 124, 444, 63, 383, 2, 322, 642, 261, 581, 200, 520, 139, 459, 78, 398, 17, 337, 657, 276, 596, 215, 535, 154, 474, 93, 413, 32, 352, 672, 291, 611, 230, 550, 169, 489, 108, 428, 47, 367, 687, 306, 626, 245, 565, 184, 504, 123, 443, 62, 382, 1, 321, 641, 260, 580, 199, 519, 138, 458, 77, 397, 16, 336, 656, 275, 595, 214, 534, 153, 473, 92, 412, 31, 351, 671, 290, 610, 229, 549, 168, 488, 107, 427, 46, 366, 686, 305, 625, 244, 564, 183, 503, 122, 442, 61, 381};
uint16_t cube_shuffle_27[NTRU_N] = {0, 238, 476, 13, 251, 489, 26, 264, 502, 39, 277, 515, 52, 290, 528, 65, 303, 541, 78, 316, 554, 91, 329, 567, 104, 342, 580, 117, 355, 593, 130, 368, 606, 143, 381, 619, 156, 394, 632, 169, 407, 645, 182, 420, 658, 195, 433, 671, 208, 446, 684, 221, 459, 697, 234, 472, 9, 247, 485, 22, 260, 498, 35, 273, 511, 48, 286, 524, 61, 299, 537, 74, 312, 550, 87, 325, 563, 100, 338, 576, 113, 351, 589, 126, 364, 602, 139, 377, 615, 152, 390, 628, 165, 403, 641, 178, 416, 654, 191, 429, 667, 204, 442, 680, 217, 455, 693, 230, 468, 5, 243, 481, 18, 256, 494, 31, 269, 507, 44, 282, 520, 57, 295, 533, 70, 308, 546, 83, 321, 559, 96, 334, 572, 109, 347, 585, 122, 360, 598, 135, 373, 611, 148, 386, 624, 161, 399, 637, 174, 412, 650, 187, 425, 663, 200, 438, 676, 213, 451, 689, 226, 464, 1, 239, 477, 14, 252, 490, 27, 265, 503, 40, 278, 516, 53, 291, 529, 66, 304, 542, 79, 317, 555, 92, 330, 568, 105, 343, 581, 118, 356, 594, 131, 369, 607, 144, 382, 620, 157, 395, 633, 170, 408, 646, 183, 421, 659, 196, 434, 672, 209, 447, 685, 222, 460, 698, 235, 473, 10, 248, 486, 23, 261, 499, 36, 274, 512, 49, 287, 525, 62, 300, 538, 75, 313, 551, 88, 326, 564, 101, 339, 577, 114, 352, 590, 127, 365, 603, 140, 378, 616, 153, 391, 629, 166, 404, 642, 179, 417, 655, 192, 430, 668, 205, 443, 681, 218, 456, 694, 231, 469, 6, 244, 482, 19, 257, 495, 32, 270, 508, 45, 283, 521, 58, 296, 534, 71, 309, 547, 84, 322, 560, 97, 335, 573, 110, 348, 586, 123, 361, 599, 136, 374, 612, 149, 387, 625, 162, 400, 638, 175, 413, 651, 188, 426, 664, 201, 439, 677, 214, 452, 690, 227, 465, 2, 240, 478, 15, 253, 491, 28, 266, 504, 41, 279, 517, 54, 292, 530, 67, 305, 543, 80, 318, 556, 93, 331, 569, 106, 344, 582, 119, 357, 595, 132, 370, 608, 145, 383, 621, 158, 396, 634, 171, 409, 647, 184, 422, 660, 197, 435, 673, 210, 448, 686, 223, 461, 699, 236, 474, 11, 249, 487, 24, 262, 500, 37, 275, 513, 50, 288, 526, 63, 301, 539, 76, 314, 552, 89, 327, 565, 102, 340, 578, 115, 353, 591, 128, 366, 604, 141, 379, 617, 154, 392, 630, 167, 405, 643, 180, 418, 656, 193, 431, 669, 206, 444, 682, 219, 457, 695, 232, 470, 7, 245, 483, 20, 258, 496, 33, 271, 509, 46, 284, 522, 59, 297, 535, 72, 310, 548, 85, 323, 561, 98, 336, 574, 111, 349, 587, 124, 362, 600, 137, 375, 613, 150, 388, 626, 163, 401, 639, 176, 414, 652, 189, 427, 665, 202, 440, 678, 215, 453, 691, 228, 466, 3, 241, 479, 16, 254, 492, 29, 267, 505, 42, 280, 518, 55, 293, 531, 68, 306, 544, 81, 319, 557, 94, 332, 570, 107, 345, 583, 120, 358, 596, 133, 371, 609, 146, 384, 622, 159, 397, 635, 172, 410, 648, 185, 423, 661, 198, 436, 674, 211, 449, 687, 224, 462, 700, 237, 475, 12, 250, 488, 25, 263, 501, 38, 276, 514, 51, 289, 527, 64, 302, 540, 77, 315, 553, 90, 328, 566, 103, 341, 579, 116, 354, 592, 129, 367, 605, 142, 380, 618, 155, 393, 631, 168, 406, 644, 181, 419, 657, 194, 432, 670, 207, 445, 683, 220, 458, 696, 233, 471, 8, 246, 484, 21, 259, 497, 34, 272, 510, 47, 285, 523, 60, 298, 536, 73, 311, 549, 86, 324, 562, 99, 337, 575, 112, 350, 588, 125, 363, 601, 138, 376, 614, 151, 389, 627, 164, 402, 640, 177, 415, 653, 190, 428, 666, 203, 441, 679, 216, 454, 692, 229, 467, 4, 242, 480, 17, 255, 493, 30, 268, 506, 43, 281, 519, 56, 294, 532, 69, 307, 545, 82, 320, 558, 95, 333, 571, 108, 346, 584, 121, 359, 597, 134, 372, 610, 147, 385, 623, 160, 398, 636, 173, 411, 649, 186, 424, 662, 199, 437, 675, 212, 450, 688, 225, 463};


uint16_t square_shuffle_1[NTRU_N] = {0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400, 402, 404, 406, 408, 410, 412, 414, 416, 418, 420, 422, 424, 426, 428, 430, 432, 434, 436, 438, 440, 442, 444, 446, 448, 450, 452, 454, 456, 458, 460, 462, 464, 466, 468, 470, 472, 474, 476, 478, 480, 482, 484, 486, 488, 490, 492, 494, 496, 498, 500, 502, 504, 506, 508, 510, 512, 514, 516, 518, 520, 522, 524, 526, 528, 530, 532, 534, 536, 538, 540, 542, 544, 546, 548, 550, 552, 554, 556, 558, 560, 562, 564, 566, 568, 570, 572, 574, 576, 578, 580, 582, 584, 586, 588, 590, 592, 594, 596, 598, 600, 602, 604, 606, 608, 610, 612, 614, 616, 618, 620, 622, 624, 626, 628, 630, 632, 634, 636, 638, 640, 642, 644, 646, 648, 650, 652, 654, 656, 658, 660, 662, 664, 666, 668, 670, 672, 674, 676, 678, 680, 682, 684, 686, 688, 690, 692, 694, 696, 698, 700, 1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 61, 63, 65, 67, 69, 71, 73, 75, 77, 79, 81, 83, 85, 87, 89, 91, 93, 95, 97, 99, 101, 103, 105, 107, 109, 111, 113, 115, 117, 119, 121, 123, 125, 127, 129, 131, 133, 135, 137, 139, 141, 143, 145, 147, 149, 151, 153, 155, 157, 159, 161, 163, 165, 167, 169, 171, 173, 175, 177, 179, 181, 183, 185, 187, 189, 191, 193, 195, 197, 199, 201, 203, 205, 207, 209, 211, 213, 215, 217, 219, 221, 223, 225, 227, 229, 231, 233, 235, 237, 239, 241, 243, 245, 247, 249, 251, 253, 255, 257, 259, 261, 263, 265, 267, 269, 271, 273, 275, 277, 279, 281, 283, 285, 287, 289, 291, 293, 295, 297, 299, 301, 303, 305, 307, 309, 311, 313, 315, 317, 319, 321, 323, 325, 327, 329, 331, 333, 335, 337, 339, 341, 343, 345, 347, 349, 351, 353, 355, 357, 359, 361, 363, 365, 367, 369, 371, 373, 375, 377, 379, 381, 383, 385, 387, 389, 391, 393, 395, 397, 399, 401, 403, 405, 407, 409, 411, 413, 415, 417, 419, 421, 423, 425, 427, 429, 431, 433, 435, 437, 439, 441, 443, 445, 447, 449, 451, 453, 455, 457, 459, 461, 463, 465, 467, 469, 471, 473, 475, 477, 479, 481, 483, 485, 487, 489, 491, 493, 495, 497, 499, 501, 503, 505, 507, 509, 511, 513, 515, 517, 519, 521, 523, 525, 527, 529, 531, 533, 535, 537, 539, 541, 543, 545, 547, 549, 551, 553, 555, 557, 559, 561, 563, 565, 567, 569, 571, 573, 575, 577, 579, 581, 583, 585, 587, 589, 591, 593, 595, 597, 599, 601, 603, 605, 607, 609, 611, 613, 615, 617, 619, 621, 623, 625, 627, 629, 631, 633, 635, 637, 639, 641, 643, 645, 647, 649, 651, 653, 655, 657, 659, 661, 663, 665, 667, 669, 671, 673, 675, 677, 679, 681, 683, 685, 687, 689, 691, 693, 695, 697, 699};
uint16_t square_shuffle_3[NTRU_N] = {0, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512, 520, 528, 536, 544, 552, 560, 568, 576, 584, 592, 600, 608, 616, 624, 632, 640, 648, 656, 664, 672, 680, 688, 696, 3, 11, 19, 27, 35, 43, 51, 59, 67, 75, 83, 91, 99, 107, 115, 123, 131, 139, 147, 155, 163, 171, 179, 187, 195, 203, 211, 219, 227, 235, 243, 251, 259, 267, 275, 283, 291, 299, 307, 315, 323, 331, 339, 347, 355, 363, 371, 379, 387, 395, 403, 411, 419, 427, 435, 443, 451, 459, 467, 475, 483, 491, 499, 507, 515, 523, 531, 539, 547, 555, 563, 571, 579, 587, 595, 603, 611, 619, 627, 635, 643, 651, 659, 667, 675, 683, 691, 699, 6, 14, 22, 30, 38, 46, 54, 62, 70, 78, 86, 94, 102, 110, 118, 126, 134, 142, 150, 158, 166, 174, 182, 190, 198, 206, 214, 222, 230, 238, 246, 254, 262, 270, 278, 286, 294, 302, 310, 318, 326, 334, 342, 350, 358, 366, 374, 382, 390, 398, 406, 414, 422, 430, 438, 446, 454, 462, 470, 478, 486, 494, 502, 510, 518, 526, 534, 542, 550, 558, 566, 574, 582, 590, 598, 606, 614, 622, 630, 638, 646, 654, 662, 670, 678, 686, 694, 1, 9, 17, 25, 33, 41, 49, 57, 65, 73, 81, 89, 97, 105, 113, 121, 129, 137, 145, 153, 161, 169, 177, 185, 193, 201, 209, 217, 225, 233, 241, 249, 257, 265, 273, 281, 289, 297, 305, 313, 321, 329, 337, 345, 353, 361, 369, 377, 385, 393, 401, 409, 417, 425, 433, 441, 449, 457, 465, 473, 481, 489, 497, 505, 513, 521, 529, 537, 545, 553, 561, 569, 577, 585, 593, 601, 609, 617, 625, 633, 641, 649, 657, 665, 673, 681, 689, 697, 4, 12, 20, 28, 36, 44, 52, 60, 68, 76, 84, 92, 100, 108, 116, 124, 132, 140, 148, 156, 164, 172, 180, 188, 196, 204, 212, 220, 228, 236, 244, 252, 260, 268, 276, 284, 292, 300, 308, 316, 324, 332, 340, 348, 356, 364, 372, 380, 388, 396, 404, 412, 420, 428, 436, 444, 452, 460, 468, 476, 484, 492, 500, 508, 516, 524, 532, 540, 548, 556, 564, 572, 580, 588, 596, 604, 612, 620, 628, 636, 644, 652, 660, 668, 676, 684, 692, 700, 7, 15, 23, 31, 39, 47, 55, 63, 71, 79, 87, 95, 103, 111, 119, 127, 135, 143, 151, 159, 167, 175, 183, 191, 199, 207, 215, 223, 231, 239, 247, 255, 263, 271, 279, 287, 295, 303, 311, 319, 327, 335, 343, 351, 359, 367, 375, 383, 391, 399, 407, 415, 423, 431, 439, 447, 455, 463, 471, 479, 487, 495, 503, 511, 519, 527, 535, 543, 551, 559, 567, 575, 583, 591, 599, 607, 615, 623, 631, 639, 647, 655, 663, 671, 679, 687, 695, 2, 10, 18, 26, 34, 42, 50, 58, 66, 74, 82, 90, 98, 106, 114, 122, 130, 138, 146, 154, 162, 170, 178, 186, 194, 202, 210, 218, 226, 234, 242, 250, 258, 266, 274, 282, 290, 298, 306, 314, 322, 330, 338, 346, 354, 362, 370, 378, 386, 394, 402, 410, 418, 426, 434, 442, 450, 458, 466, 474, 482, 490, 498, 506, 514, 522, 530, 538, 546, 554, 562, 570, 578, 586, 594, 602, 610, 618, 626, 634, 642, 650, 658, 666, 674, 682, 690, 698, 5, 13, 21, 29, 37, 45, 53, 61, 69, 77, 85, 93, 101, 109, 117, 125, 133, 141, 149, 157, 165, 173, 181, 189, 197, 205, 213, 221, 229, 237, 245, 253, 261, 269, 277, 285, 293, 301, 309, 317, 325, 333, 341, 349, 357, 365, 373, 381, 389, 397, 405, 413, 421, 429, 437, 445, 453, 461, 469, 477, 485, 493, 501, 509, 517, 525, 533, 541, 549, 557, 565, 573, 581, 589, 597, 605, 613, 621, 629, 637, 645, 653, 661, 669, 677, 685, 693};
uint16_t square_shuffle_6[NTRU_N] = {0, 64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 3, 67, 131, 195, 259, 323, 387, 451, 515, 579, 643, 6, 70, 134, 198, 262, 326, 390, 454, 518, 582, 646, 9, 73, 137, 201, 265, 329, 393, 457, 521, 585, 649, 12, 76, 140, 204, 268, 332, 396, 460, 524, 588, 652, 15, 79, 143, 207, 271, 335, 399, 463, 527, 591, 655, 18, 82, 146, 210, 274, 338, 402, 466, 530, 594, 658, 21, 85, 149, 213, 277, 341, 405, 469, 533, 597, 661, 24, 88, 152, 216, 280, 344, 408, 472, 536, 600, 664, 27, 91, 155, 219, 283, 347, 411, 475, 539, 603, 667, 30, 94, 158, 222, 286, 350, 414, 478, 542, 606, 670, 33, 97, 161, 225, 289, 353, 417, 481, 545, 609, 673, 36, 100, 164, 228, 292, 356, 420, 484, 548, 612, 676, 39, 103, 167, 231, 295, 359, 423, 487, 551, 615, 679, 42, 106, 170, 234, 298, 362, 426, 490, 554, 618, 682, 45, 109, 173, 237, 301, 365, 429, 493, 557, 621, 685, 48, 112, 176, 240, 304, 368, 432, 496, 560, 624, 688, 51, 115, 179, 243, 307, 371, 435, 499, 563, 627, 691, 54, 118, 182, 246, 310, 374, 438, 502, 566, 630, 694, 57, 121, 185, 249, 313, 377, 441, 505, 569, 633, 697, 60, 124, 188, 252, 316, 380, 444, 508, 572, 636, 700, 63, 127, 191, 255, 319, 383, 447, 511, 575, 639, 2, 66, 130, 194, 258, 322, 386, 450, 514, 578, 642, 5, 69, 133, 197, 261, 325, 389, 453, 517, 581, 645, 8, 72, 136, 200, 264, 328, 392, 456, 520, 584, 648, 11, 75, 139, 203, 267, 331, 395, 459, 523, 587, 651, 14, 78, 142, 206, 270, 334, 398, 462, 526, 590, 654, 17, 81, 145, 209, 273, 337, 401, 465, 529, 593, 657, 20, 84, 148, 212, 276, 340, 404, 468, 532, 596, 660, 23, 87, 151, 215, 279, 343, 407, 471, 535, 599, 663, 26, 90, 154, 218, 282, 346, 410, 474, 538, 602, 666, 29, 93, 157, 221, 285, 349, 413, 477, 541, 605, 669, 32, 96, 160, 224, 288, 352, 416, 480, 544, 608, 672, 35, 99, 163, 227, 291, 355, 419, 483, 547, 611, 675, 38, 102, 166, 230, 294, 358, 422, 486, 550, 614, 678, 41, 105, 169, 233, 297, 361, 425, 489, 553, 617, 681, 44, 108, 172, 236, 300, 364, 428, 492, 556, 620, 684, 47, 111, 175, 239, 303, 367, 431, 495, 559, 623, 687, 50, 114, 178, 242, 306, 370, 434, 498, 562, 626, 690, 53, 117, 181, 245, 309, 373, 437, 501, 565, 629, 693, 56, 120, 184, 248, 312, 376, 440, 504, 568, 632, 696, 59, 123, 187, 251, 315, 379, 443, 507, 571, 635, 699, 62, 126, 190, 254, 318, 382, 446, 510, 574, 638, 1, 65, 129, 193, 257, 321, 385, 449, 513, 577, 641, 4, 68, 132, 196, 260, 324, 388, 452, 516, 580, 644, 7, 71, 135, 199, 263, 327, 391, 455, 519, 583, 647, 10, 74, 138, 202, 266, 330, 394, 458, 522, 586, 650, 13, 77, 141, 205, 269, 333, 397, 461, 525, 589, 653, 16, 80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 19, 83, 147, 211, 275, 339, 403, 467, 531, 595, 659, 22, 86, 150, 214, 278, 342, 406, 470, 534, 598, 662, 25, 89, 153, 217, 281, 345, 409, 473, 537, 601, 665, 28, 92, 156, 220, 284, 348, 412, 476, 540, 604, 668, 31, 95, 159, 223, 287, 351, 415, 479, 543, 607, 671, 34, 98, 162, 226, 290, 354, 418, 482, 546, 610, 674, 37, 101, 165, 229, 293, 357, 421, 485, 549, 613, 677, 40, 104, 168, 232, 296, 360, 424, 488, 552, 616, 680, 43, 107, 171, 235, 299, 363, 427, 491, 555, 619, 683, 46, 110, 174, 238, 302, 366, 430, 494, 558, 622, 686, 49, 113, 177, 241, 305, 369, 433, 497, 561, 625, 689, 52, 116, 180, 244, 308, 372, 436, 500, 564, 628, 692, 55, 119, 183, 247, 311, 375, 439, 503, 567, 631, 695, 58, 122, 186, 250, 314, 378, 442, 506, 570, 634, 698, 61, 125, 189, 253, 317, 381, 445, 509, 573, 637};
uint16_t square_shuffle_12[NTRU_N] = {0, 591, 481, 371, 261, 151, 41, 632, 522, 412, 302, 192, 82, 673, 563, 453, 343, 233, 123, 13, 604, 494, 384, 274, 164, 54, 645, 535, 425, 315, 205, 95, 686, 576, 466, 356, 246, 136, 26, 617, 507, 397, 287, 177, 67, 658, 548, 438, 328, 218, 108, 699, 589, 479, 369, 259, 149, 39, 630, 520, 410, 300, 190, 80, 671, 561, 451, 341, 231, 121, 11, 602, 492, 382, 272, 162, 52, 643, 533, 423, 313, 203, 93, 684, 574, 464, 354, 244, 134, 24, 615, 505, 395, 285, 175, 65, 656, 546, 436, 326, 216, 106, 697, 587, 477, 367, 257, 147, 37, 628, 518, 408, 298, 188, 78, 669, 559, 449, 339, 229, 119, 9, 600, 490, 380, 270, 160, 50, 641, 531, 421, 311, 201, 91, 682, 572, 462, 352, 242, 132, 22, 613, 503, 393, 283, 173, 63, 654, 544, 434, 324, 214, 104, 695, 585, 475, 365, 255, 145, 35, 626, 516, 406, 296, 186, 76, 667, 557, 447, 337, 227, 117, 7, 598, 488, 378, 268, 158, 48, 639, 529, 419, 309, 199, 89, 680, 570, 460, 350, 240, 130, 20, 611, 501, 391, 281, 171, 61, 652, 542, 432, 322, 212, 102, 693, 583, 473, 363, 253, 143, 33, 624, 514, 404, 294, 184, 74, 665, 555, 445, 335, 225, 115, 5, 596, 486, 376, 266, 156, 46, 637, 527, 417, 307, 197, 87, 678, 568, 458, 348, 238, 128, 18, 609, 499, 389, 279, 169, 59, 650, 540, 430, 320, 210, 100, 691, 581, 471, 361, 251, 141, 31, 622, 512, 402, 292, 182, 72, 663, 553, 443, 333, 223, 113, 3, 594, 484, 374, 264, 154, 44, 635, 525, 415, 305, 195, 85, 676, 566, 456, 346, 236, 126, 16, 607, 497, 387, 277, 167, 57, 648, 538, 428, 318, 208, 98, 689, 579, 469, 359, 249, 139, 29, 620, 510, 400, 290, 180, 70, 661, 551, 441, 331, 221, 111, 1, 592, 482, 372, 262, 152, 42, 633, 523, 413, 303, 193, 83, 674, 564, 454, 344, 234, 124, 14, 605, 495, 385, 275, 165, 55, 646, 536, 426, 316, 206, 96, 687, 577, 467, 357, 247, 137, 27, 618, 508, 398, 288, 178, 68, 659, 549, 439, 329, 219, 109, 700, 590, 480, 370, 260, 150, 40, 631, 521, 411, 301, 191, 81, 672, 562, 452, 342, 232, 122, 12, 603, 493, 383, 273, 163, 53, 644, 534, 424, 314, 204, 94, 685, 575, 465, 355, 245, 135, 25, 616, 506, 396, 286, 176, 66, 657, 547, 437, 327, 217, 107, 698, 588, 478, 368, 258, 148, 38, 629, 519, 409, 299, 189, 79, 670, 560, 450, 340, 230, 120, 10, 601, 491, 381, 271, 161, 51, 642, 532, 422, 312, 202, 92, 683, 573, 463, 353, 243, 133, 23, 614, 504, 394, 284, 174, 64, 655, 545, 435, 325, 215, 105, 696, 586, 476, 366, 256, 146, 36, 627, 517, 407, 297, 187, 77, 668, 558, 448, 338, 228, 118, 8, 599, 489, 379, 269, 159, 49, 640, 530, 420, 310, 200, 90, 681, 571, 461, 351, 241, 131, 21, 612, 502, 392, 282, 172, 62, 653, 543, 433, 323, 213, 103, 694, 584, 474, 364, 254, 144, 34, 625, 515, 405, 295, 185, 75, 666, 556, 446, 336, 226, 116, 6, 597, 487, 377, 267, 157, 47, 638, 528, 418, 308, 198, 88, 679, 569, 459, 349, 239, 129, 19, 610, 500, 390, 280, 170, 60, 651, 541, 431, 321, 211, 101, 692, 582, 472, 362, 252, 142, 32, 623, 513, 403, 293, 183, 73, 664, 554, 444, 334, 224, 114, 4, 595, 485, 375, 265, 155, 45, 636, 526, 416, 306, 196, 86, 677, 567, 457, 347, 237, 127, 17, 608, 498, 388, 278, 168, 58, 649, 539, 429, 319, 209, 99, 690, 580, 470, 360, 250, 140, 30, 621, 511, 401, 291, 181, 71, 662, 552, 442, 332, 222, 112, 2, 593, 483, 373, 263, 153, 43, 634, 524, 414, 304, 194, 84, 675, 565, 455, 345, 235, 125, 15, 606, 496, 386, 276, 166, 56, 647, 537, 427, 317, 207, 97, 688, 578, 468, 358, 248, 138, 28, 619, 509, 399, 289, 179, 69, 660, 550, 440, 330, 220, 110};
uint16_t square_shuffle_15[NTRU_N] = {0, 522, 343, 164, 686, 507, 328, 149, 671, 492, 313, 134, 656, 477, 298, 119, 641, 462, 283, 104, 626, 447, 268, 89, 611, 432, 253, 74, 596, 417, 238, 59, 581, 402, 223, 44, 566, 387, 208, 29, 551, 372, 193, 14, 536, 357, 178, 700, 521, 342, 163, 685, 506, 327, 148, 670, 491, 312, 133, 655, 476, 297, 118, 640, 461, 282, 103, 625, 446, 267, 88, 610, 431, 252, 73, 595, 416, 237, 58, 580, 401, 222, 43, 565, 386, 207, 28, 550, 371, 192, 13, 535, 356, 177, 699, 520, 341, 162, 684, 505, 326, 147, 669, 490, 311, 132, 654, 475, 296, 117, 639, 460, 281, 102, 624, 445, 266, 87, 609, 430, 251, 72, 594, 415, 236, 57, 579, 400, 221, 42, 564, 385, 206, 27, 549, 370, 191, 12, 534, 355, 176, 698, 519, 340, 161, 683, 504, 325, 146, 668, 489, 310, 131, 653, 474, 295, 116, 638, 459, 280, 101, 623, 444, 265, 86, 608, 429, 250, 71, 593, 414, 235, 56, 578, 399, 220, 41, 563, 384, 205, 26, 548, 369, 190, 11, 533, 354, 175, 697, 518, 339, 160, 682, 503, 324, 145, 667, 488, 309, 130, 652, 473, 294, 115, 637, 458, 279, 100, 622, 443, 264, 85, 607, 428, 249, 70, 592, 413, 234, 55, 577, 398, 219, 40, 562, 383, 204, 25, 547, 368, 189, 10, 532, 353, 174, 696, 517, 338, 159, 681, 502, 323, 144, 666, 487, 308, 129, 651, 472, 293, 114, 636, 457, 278, 99, 621, 442, 263, 84, 606, 427, 248, 69, 591, 412, 233, 54, 576, 397, 218, 39, 561, 382, 203, 24, 546, 367, 188, 9, 531, 352, 173, 695, 516, 337, 158, 680, 501, 322, 143, 665, 486, 307, 128, 650, 471, 292, 113, 635, 456, 277, 98, 620, 441, 262, 83, 605, 426, 247, 68, 590, 411, 232, 53, 575, 396, 217, 38, 560, 381, 202, 23, 545, 366, 187, 8, 530, 351, 172, 694, 515, 336, 157, 679, 500, 321, 142, 664, 485, 306, 127, 649, 470, 291, 112, 634, 455, 276, 97, 619, 440, 261, 82, 604, 425, 246, 67, 589, 410, 231, 52, 574, 395, 216, 37, 559, 380, 201, 22, 544, 365, 186, 7, 529, 350, 171, 693, 514, 335, 156, 678, 499, 320, 141, 663, 484, 305, 126, 648, 469, 290, 111, 633, 454, 275, 96, 618, 439, 260, 81, 603, 424, 245, 66, 588, 409, 230, 51, 573, 394, 215, 36, 558, 379, 200, 21, 543, 364, 185, 6, 528, 349, 170, 692, 513, 334, 155, 677, 498, 319, 140, 662, 483, 304, 125, 647, 468, 289, 110, 632, 453, 274, 95, 617, 438, 259, 80, 602, 423, 244, 65, 587, 408, 229, 50, 572, 393, 214, 35, 557, 378, 199, 20, 542, 363, 184, 5, 527, 348, 169, 691, 512, 333, 154, 676, 497, 318, 139, 661, 482, 303, 124, 646, 467, 288, 109, 631, 452, 273, 94, 616, 437, 258, 79, 601, 422, 243, 64, 586, 407, 228, 49, 571, 392, 213, 34, 556, 377, 198, 19, 541, 362, 183, 4, 526, 347, 168, 690, 511, 332, 153, 675, 496, 317, 138, 660, 481, 302, 123, 645, 466, 287, 108, 630, 451, 272, 93, 615, 436, 257, 78, 600, 421, 242, 63, 585, 406, 227, 48, 570, 391, 212, 33, 555, 376, 197, 18, 540, 361, 182, 3, 525, 346, 167, 689, 510, 331, 152, 674, 495, 316, 137, 659, 480, 301, 122, 644, 465, 286, 107, 629, 450, 271, 92, 614, 435, 256, 77, 599, 420, 241, 62, 584, 405, 226, 47, 569, 390, 211, 32, 554, 375, 196, 17, 539, 360, 181, 2, 524, 345, 166, 688, 509, 330, 151, 673, 494, 315, 136, 658, 479, 300, 121, 643, 464, 285, 106, 628, 449, 270, 91, 613, 434, 255, 76, 598, 419, 240, 61, 583, 404, 225, 46, 568, 389, 210, 31, 553, 374, 195, 16, 538, 359, 180, 1, 523, 344, 165, 687, 508, 329, 150, 672, 493, 314, 135, 657, 478, 299, 120, 642, 463, 284, 105, 627, 448, 269, 90, 612, 433, 254, 75, 597, 418, 239, 60, 582, 403, 224, 45, 567, 388, 209, 30, 552, 373, 194, 15, 537, 358, 179};
uint16_t square_shuffle_42[NTRU_N] = {0, 118, 236, 354, 472, 590, 7, 125, 243, 361, 479, 597, 14, 132, 250, 368, 486, 604, 21, 139, 257, 375, 493, 611, 28, 146, 264, 382, 500, 618, 35, 153, 271, 389, 507, 625, 42, 160, 278, 396, 514, 632, 49, 167, 285, 403, 521, 639, 56, 174, 292, 410, 528, 646, 63, 181, 299, 417, 535, 653, 70, 188, 306, 424, 542, 660, 77, 195, 313, 431, 549, 667, 84, 202, 320, 438, 556, 674, 91, 209, 327, 445, 563, 681, 98, 216, 334, 452, 570, 688, 105, 223, 341, 459, 577, 695, 112, 230, 348, 466, 584, 1, 119, 237, 355, 473, 591, 8, 126, 244, 362, 480, 598, 15, 133, 251, 369, 487, 605, 22, 140, 258, 376, 494, 612, 29, 147, 265, 383, 501, 619, 36, 154, 272, 390, 508, 626, 43, 161, 279, 397, 515, 633, 50, 168, 286, 404, 522, 640, 57, 175, 293, 411, 529, 647, 64, 182, 300, 418, 536, 654, 71, 189, 307, 425, 543, 661, 78, 196, 314, 432, 550, 668, 85, 203, 321, 439, 557, 675, 92, 210, 328, 446, 564, 682, 99, 217, 335, 453, 571, 689, 106, 224, 342, 460, 578, 696, 113, 231, 349, 467, 585, 2, 120, 238, 356, 474, 592, 9, 127, 245, 363, 481, 599, 16, 134, 252, 370, 488, 606, 23, 141, 259, 377, 495, 613, 30, 148, 266, 384, 502, 620, 37, 155, 273, 391, 509, 627, 44, 162, 280, 398, 516, 634, 51, 169, 287, 405, 523, 641, 58, 176, 294, 412, 530, 648, 65, 183, 301, 419, 537, 655, 72, 190, 308, 426, 544, 662, 79, 197, 315, 433, 551, 669, 86, 204, 322, 440, 558, 676, 93, 211, 329, 447, 565, 683, 100, 218, 336, 454, 572, 690, 107, 225, 343, 461, 579, 697, 114, 232, 350, 468, 586, 3, 121, 239, 357, 475, 593, 10, 128, 246, 364, 482, 600, 17, 135, 253, 371, 489, 607, 24, 142, 260, 378, 496, 614, 31, 149, 267, 385, 503, 621, 38, 156, 274, 392, 510, 628, 45, 163, 281, 399, 517, 635, 52, 170, 288, 406, 524, 642, 59, 177, 295, 413, 531, 649, 66, 184, 302, 420, 538, 656, 73, 191, 309, 427, 545, 663, 80, 198, 316, 434, 552, 670, 87, 205, 323, 441, 559, 677, 94, 212, 330, 448, 566, 684, 101, 219, 337, 455, 573, 691, 108, 226, 344, 462, 580, 698, 115, 233, 351, 469, 587, 4, 122, 240, 358, 476, 594, 11, 129, 247, 365, 483, 601, 18, 136, 254, 372, 490, 608, 25, 143, 261, 379, 497, 615, 32, 150, 268, 386, 504, 622, 39, 157, 275, 393, 511, 629, 46, 164, 282, 400, 518, 636, 53, 171, 289, 407, 525, 643, 60, 178, 296, 414, 532, 650, 67, 185, 303, 421, 539, 657, 74, 192, 310, 428, 546, 664, 81, 199, 317, 435, 553, 671, 88, 206, 324, 442, 560, 678, 95, 213, 331, 449, 567, 685, 102, 220, 338, 456, 574, 692, 109, 227, 345, 463, 581, 699, 116, 234, 352, 470, 588, 5, 123, 241, 359, 477, 595, 12, 130, 248, 366, 484, 602, 19, 137, 255, 373, 491, 609, 26, 144, 262, 380, 498, 616, 33, 151, 269, 387, 505, 623, 40, 158, 276, 394, 512, 630, 47, 165, 283, 401, 519, 637, 54, 172, 290, 408, 526, 644, 61, 179, 297, 415, 533, 651, 68, 186, 304, 422, 540, 658, 75, 193, 311, 429, 547, 665, 82, 200, 318, 436, 554, 672, 89, 207, 325, 443, 561, 679, 96, 214, 332, 450, 568, 686, 103, 221, 339, 457, 575, 693, 110, 228, 346, 464, 582, 700, 117, 235, 353, 471, 589, 6, 124, 242, 360, 478, 596, 13, 131, 249, 367, 485, 603, 20, 138, 256, 374, 492, 610, 27, 145, 263, 381, 499, 617, 34, 152, 270, 388, 506, 624, 41, 159, 277, 395, 513, 631, 48, 166, 284, 402, 520, 638, 55, 173, 291, 409, 527, 645, 62, 180, 298, 416, 534, 652, 69, 187, 305, 423, 541, 659, 76, 194, 312, 430, 548, 666, 83, 201, 319, 437, 555, 673, 90, 208, 326, 444, 562, 680, 97, 215, 333, 451, 569, 687, 104, 222, 340, 458, 576, 694, 111, 229, 347, 465, 583};
uint16_t square_shuffle_84[NTRU_N] = {0, 605, 509, 413, 317, 221, 125, 29, 634, 538, 442, 346, 250, 154, 58, 663, 567, 471, 375, 279, 183, 87, 692, 596, 500, 404, 308, 212, 116, 20, 625, 529, 433, 337, 241, 145, 49, 654, 558, 462, 366, 270, 174, 78, 683, 587, 491, 395, 299, 203, 107, 11, 616, 520, 424, 328, 232, 136, 40, 645, 549, 453, 357, 261, 165, 69, 674, 578, 482, 386, 290, 194, 98, 2, 607, 511, 415, 319, 223, 127, 31, 636, 540, 444, 348, 252, 156, 60, 665, 569, 473, 377, 281, 185, 89, 694, 598, 502, 406, 310, 214, 118, 22, 627, 531, 435, 339, 243, 147, 51, 656, 560, 464, 368, 272, 176, 80, 685, 589, 493, 397, 301, 205, 109, 13, 618, 522, 426, 330, 234, 138, 42, 647, 551, 455, 359, 263, 167, 71, 676, 580, 484, 388, 292, 196, 100, 4, 609, 513, 417, 321, 225, 129, 33, 638, 542, 446, 350, 254, 158, 62, 667, 571, 475, 379, 283, 187, 91, 696, 600, 504, 408, 312, 216, 120, 24, 629, 533, 437, 341, 245, 149, 53, 658, 562, 466, 370, 274, 178, 82, 687, 591, 495, 399, 303, 207, 111, 15, 620, 524, 428, 332, 236, 140, 44, 649, 553, 457, 361, 265, 169, 73, 678, 582, 486, 390, 294, 198, 102, 6, 611, 515, 419, 323, 227, 131, 35, 640, 544, 448, 352, 256, 160, 64, 669, 573, 477, 381, 285, 189, 93, 698, 602, 506, 410, 314, 218, 122, 26, 631, 535, 439, 343, 247, 151, 55, 660, 564, 468, 372, 276, 180, 84, 689, 593, 497, 401, 305, 209, 113, 17, 622, 526, 430, 334, 238, 142, 46, 651, 555, 459, 363, 267, 171, 75, 680, 584, 488, 392, 296, 200, 104, 8, 613, 517, 421, 325, 229, 133, 37, 642, 546, 450, 354, 258, 162, 66, 671, 575, 479, 383, 287, 191, 95, 700, 604, 508, 412, 316, 220, 124, 28, 633, 537, 441, 345, 249, 153, 57, 662, 566, 470, 374, 278, 182, 86, 691, 595, 499, 403, 307, 211, 115, 19, 624, 528, 432, 336, 240, 144, 48, 653, 557, 461, 365, 269, 173, 77, 682, 586, 490, 394, 298, 202, 106, 10, 615, 519, 423, 327, 231, 135, 39, 644, 548, 452, 356, 260, 164, 68, 673, 577, 481, 385, 289, 193, 97, 1, 606, 510, 414, 318, 222, 126, 30, 635, 539, 443, 347, 251, 155, 59, 664, 568, 472, 376, 280, 184, 88, 693, 597, 501, 405, 309, 213, 117, 21, 626, 530, 434, 338, 242, 146, 50, 655, 559, 463, 367, 271, 175, 79, 684, 588, 492, 396, 300, 204, 108, 12, 617, 521, 425, 329, 233, 137, 41, 646, 550, 454, 358, 262, 166, 70, 675, 579, 483, 387, 291, 195, 99, 3, 608, 512, 416, 320, 224, 128, 32, 637, 541, 445, 349, 253, 157, 61, 666, 570, 474, 378, 282, 186, 90, 695, 599, 503, 407, 311, 215, 119, 23, 628, 532, 436, 340, 244, 148, 52, 657, 561, 465, 369, 273, 177, 81, 686, 590, 494, 398, 302, 206, 110, 14, 619, 523, 427, 331, 235, 139, 43, 648, 552, 456, 360, 264, 168, 72, 677, 581, 485, 389, 293, 197, 101, 5, 610, 514, 418, 322, 226, 130, 34, 639, 543, 447, 351, 255, 159, 63, 668, 572, 476, 380, 284, 188, 92, 697, 601, 505, 409, 313, 217, 121, 25, 630, 534, 438, 342, 246, 150, 54, 659, 563, 467, 371, 275, 179, 83, 688, 592, 496, 400, 304, 208, 112, 16, 621, 525, 429, 333, 237, 141, 45, 650, 554, 458, 362, 266, 170, 74, 679, 583, 487, 391, 295, 199, 103, 7, 612, 516, 420, 324, 228, 132, 36, 641, 545, 449, 353, 257, 161, 65, 670, 574, 478, 382, 286, 190, 94, 699, 603, 507, 411, 315, 219, 123, 27, 632, 536, 440, 344, 248, 152, 56, 661, 565, 469, 373, 277, 181, 85, 690, 594, 498, 402, 306, 210, 114, 18, 623, 527, 431, 335, 239, 143, 47, 652, 556, 460, 364, 268, 172, 76, 681, 585, 489, 393, 297, 201, 105, 9, 614, 518, 422, 326, 230, 134, 38, 643, 547, 451, 355, 259, 163, 67, 672, 576, 480, 384, 288, 192, 96};
uint16_t square_shuffle_168[NTRU_N] = {0, 103, 206, 309, 412, 515, 618, 20, 123, 226, 329, 432, 535, 638, 40, 143, 246, 349, 452, 555, 658, 60, 163, 266, 369, 472, 575, 678, 80, 183, 286, 389, 492, 595, 698, 100, 203, 306, 409, 512, 615, 17, 120, 223, 326, 429, 532, 635, 37, 140, 243, 346, 449, 552, 655, 57, 160, 263, 366, 469, 572, 675, 77, 180, 283, 386, 489, 592, 695, 97, 200, 303, 406, 509, 612, 14, 117, 220, 323, 426, 529, 632, 34, 137, 240, 343, 446, 549, 652, 54, 157, 260, 363, 466, 569, 672, 74, 177, 280, 383, 486, 589, 692, 94, 197, 300, 403, 506, 609, 11, 114, 217, 320, 423, 526, 629, 31, 134, 237, 340, 443, 546, 649, 51, 154, 257, 360, 463, 566, 669, 71, 174, 277, 380, 483, 586, 689, 91, 194, 297, 400, 503, 606, 8, 111, 214, 317, 420, 523, 626, 28, 131, 234, 337, 440, 543, 646, 48, 151, 254, 357, 460, 563, 666, 68, 171, 274, 377, 480, 583, 686, 88, 191, 294, 397, 500, 603, 5, 108, 211, 314, 417, 520, 623, 25, 128, 231, 334, 437, 540, 643, 45, 148, 251, 354, 457, 560, 663, 65, 168, 271, 374, 477, 580, 683, 85, 188, 291, 394, 497, 600, 2, 105, 208, 311, 414, 517, 620, 22, 125, 228, 331, 434, 537, 640, 42, 145, 248, 351, 454, 557, 660, 62, 165, 268, 371, 474, 577, 680, 82, 185, 288, 391, 494, 597, 700, 102, 205, 308, 411, 514, 617, 19, 122, 225, 328, 431, 534, 637, 39, 142, 245, 348, 451, 554, 657, 59, 162, 265, 368, 471, 574, 677, 79, 182, 285, 388, 491, 594, 697, 99, 202, 305, 408, 511, 614, 16, 119, 222, 325, 428, 531, 634, 36, 139, 242, 345, 448, 551, 654, 56, 159, 262, 365, 468, 571, 674, 76, 179, 282, 385, 488, 591, 694, 96, 199, 302, 405, 508, 611, 13, 116, 219, 322, 425, 528, 631, 33, 136, 239, 342, 445, 548, 651, 53, 156, 259, 362, 465, 568, 671, 73, 176, 279, 382, 485, 588, 691, 93, 196, 299, 402, 505, 608, 10, 113, 216, 319, 422, 525, 628, 30, 133, 236, 339, 442, 545, 648, 50, 153, 256, 359, 462, 565, 668, 70, 173, 276, 379, 482, 585, 688, 90, 193, 296, 399, 502, 605, 7, 110, 213, 316, 419, 522, 625, 27, 130, 233, 336, 439, 542, 645, 47, 150, 253, 356, 459, 562, 665, 67, 170, 273, 376, 479, 582, 685, 87, 190, 293, 396, 499, 602, 4, 107, 210, 313, 416, 519, 622, 24, 127, 230, 333, 436, 539, 642, 44, 147, 250, 353, 456, 559, 662, 64, 167, 270, 373, 476, 579, 682, 84, 187, 290, 393, 496, 599, 1, 104, 207, 310, 413, 516, 619, 21, 124, 227, 330, 433, 536, 639, 41, 144, 247, 350, 453, 556, 659, 61, 164, 267, 370, 473, 576, 679, 81, 184, 287, 390, 493, 596, 699, 101, 204, 307, 410, 513, 616, 18, 121, 224, 327, 430, 533, 636, 38, 141, 244, 347, 450, 553, 656, 58, 161, 264, 367, 470, 573, 676, 78, 181, 284, 387, 490, 593, 696, 98, 201, 304, 407, 510, 613, 15, 118, 221, 324, 427, 530, 633, 35, 138, 241, 344, 447, 550, 653, 55, 158, 261, 364, 467, 570, 673, 75, 178, 281, 384, 487, 590, 693, 95, 198, 301, 404, 507, 610, 12, 115, 218, 321, 424, 527, 630, 32, 135, 238, 341, 444, 547, 650, 52, 155, 258, 361, 464, 567, 670, 72, 175, 278, 381, 484, 587, 690, 92, 195, 298, 401, 504, 607, 9, 112, 215, 318, 421, 524, 627, 29, 132, 235, 338, 441, 544, 647, 49, 152, 255, 358, 461, 564, 667, 69, 172, 275, 378, 481, 584, 687, 89, 192, 295, 398, 501, 604, 6, 109, 212, 315, 418, 521, 624, 26, 129, 232, 335, 438, 541, 644, 46, 149, 252, 355, 458, 561, 664, 66, 169, 272, 375, 478, 581, 684, 86, 189, 292, 395, 498, 601, 3, 106, 209, 312, 415, 518, 621, 23, 126, 229, 332, 435, 538, 641, 43, 146, 249, 352, 455, 558, 661, 63, 166, 269, 372, 475, 578, 681, 83, 186, 289, 392, 495, 598};
uint16_t square_shuffle_336[NTRU_N] = {0, 94, 188, 282, 376, 470, 564, 658, 51, 145, 239, 333, 427, 521, 615, 8, 102, 196, 290, 384, 478, 572, 666, 59, 153, 247, 341, 435, 529, 623, 16, 110, 204, 298, 392, 486, 580, 674, 67, 161, 255, 349, 443, 537, 631, 24, 118, 212, 306, 400, 494, 588, 682, 75, 169, 263, 357, 451, 545, 639, 32, 126, 220, 314, 408, 502, 596, 690, 83, 177, 271, 365, 459, 553, 647, 40, 134, 228, 322, 416, 510, 604, 698, 91, 185, 279, 373, 467, 561, 655, 48, 142, 236, 330, 424, 518, 612, 5, 99, 193, 287, 381, 475, 569, 663, 56, 150, 244, 338, 432, 526, 620, 13, 107, 201, 295, 389, 483, 577, 671, 64, 158, 252, 346, 440, 534, 628, 21, 115, 209, 303, 397, 491, 585, 679, 72, 166, 260, 354, 448, 542, 636, 29, 123, 217, 311, 405, 499, 593, 687, 80, 174, 268, 362, 456, 550, 644, 37, 131, 225, 319, 413, 507, 601, 695, 88, 182, 276, 370, 464, 558, 652, 45, 139, 233, 327, 421, 515, 609, 2, 96, 190, 284, 378, 472, 566, 660, 53, 147, 241, 335, 429, 523, 617, 10, 104, 198, 292, 386, 480, 574, 668, 61, 155, 249, 343, 437, 531, 625, 18, 112, 206, 300, 394, 488, 582, 676, 69, 163, 257, 351, 445, 539, 633, 26, 120, 214, 308, 402, 496, 590, 684, 77, 171, 265, 359, 453, 547, 641, 34, 128, 222, 316, 410, 504, 598, 692, 85, 179, 273, 367, 461, 555, 649, 42, 136, 230, 324, 418, 512, 606, 700, 93, 187, 281, 375, 469, 563, 657, 50, 144, 238, 332, 426, 520, 614, 7, 101, 195, 289, 383, 477, 571, 665, 58, 152, 246, 340, 434, 528, 622, 15, 109, 203, 297, 391, 485, 579, 673, 66, 160, 254, 348, 442, 536, 630, 23, 117, 211, 305, 399, 493, 587, 681, 74, 168, 262, 356, 450, 544, 638, 31, 125, 219, 313, 407, 501, 595, 689, 82, 176, 270, 364, 458, 552, 646, 39, 133, 227, 321, 415, 509, 603, 697, 90, 184, 278, 372, 466, 560, 654, 47, 141, 235, 329, 423, 517, 611, 4, 98, 192, 286, 380, 474, 568, 662, 55, 149, 243, 337, 431, 525, 619, 12, 106, 200, 294, 388, 482, 576, 670, 63, 157, 251, 345, 439, 533, 627, 20, 114, 208, 302, 396, 490, 584, 678, 71, 165, 259, 353, 447, 541, 635, 28, 122, 216, 310, 404, 498, 592, 686, 79, 173, 267, 361, 455, 549, 643, 36, 130, 224, 318, 412, 506, 600, 694, 87, 181, 275, 369, 463, 557, 651, 44, 138, 232, 326, 420, 514, 608, 1, 95, 189, 283, 377, 471, 565, 659, 52, 146, 240, 334, 428, 522, 616, 9, 103, 197, 291, 385, 479, 573, 667, 60, 154, 248, 342, 436, 530, 624, 17, 111, 205, 299, 393, 487, 581, 675, 68, 162, 256, 350, 444, 538, 632, 25, 119, 213, 307, 401, 495, 589, 683, 76, 170, 264, 358, 452, 546, 640, 33, 127, 221, 315, 409, 503, 597, 691, 84, 178, 272, 366, 460, 554, 648, 41, 135, 229, 323, 417, 511, 605, 699, 92, 186, 280, 374, 468, 562, 656, 49, 143, 237, 331, 425, 519, 613, 6, 100, 194, 288, 382, 476, 570, 664, 57, 151, 245, 339, 433, 527, 621, 14, 108, 202, 296, 390, 484, 578, 672, 65, 159, 253, 347, 441, 535, 629, 22, 116, 210, 304, 398, 492, 586, 680, 73, 167, 261, 355, 449, 543, 637, 30, 124, 218, 312, 406, 500, 594, 688, 81, 175, 269, 363, 457, 551, 645, 38, 132, 226, 320, 414, 508, 602, 696, 89, 183, 277, 371, 465, 559, 653, 46, 140, 234, 328, 422, 516, 610, 3, 97, 191, 285, 379, 473, 567, 661, 54, 148, 242, 336, 430, 524, 618, 11, 105, 199, 293, 387, 481, 575, 669, 62, 156, 250, 344, 438, 532, 626, 19, 113, 207, 301, 395, 489, 583, 677, 70, 164, 258, 352, 446, 540, 634, 27, 121, 215, 309, 403, 497, 591, 685, 78, 172, 266, 360, 454, 548, 642, 35, 129, 223, 317, 411, 505, 599, 693, 86, 180, 274, 368, 462, 556, 650, 43, 137, 231, 325, 419, 513, 607};
uint16_t square_shuffle_27[NTRU_N] = {0, 62, 124, 186, 248, 310, 372, 434, 496, 558, 620, 682, 43, 105, 167, 229, 291, 353, 415, 477, 539, 601, 663, 24, 86, 148, 210, 272, 334, 396, 458, 520, 582, 644, 5, 67, 129, 191, 253, 315, 377, 439, 501, 563, 625, 687, 48, 110, 172, 234, 296, 358, 420, 482, 544, 606, 668, 29, 91, 153, 215, 277, 339, 401, 463, 525, 587, 649, 10, 72, 134, 196, 258, 320, 382, 444, 506, 568, 630, 692, 53, 115, 177, 239, 301, 363, 425, 487, 549, 611, 673, 34, 96, 158, 220, 282, 344, 406, 468, 530, 592, 654, 15, 77, 139, 201, 263, 325, 387, 449, 511, 573, 635, 697, 58, 120, 182, 244, 306, 368, 430, 492, 554, 616, 678, 39, 101, 163, 225, 287, 349, 411, 473, 535, 597, 659, 20, 82, 144, 206, 268, 330, 392, 454, 516, 578, 640, 1, 63, 125, 187, 249, 311, 373, 435, 497, 559, 621, 683, 44, 106, 168, 230, 292, 354, 416, 478, 540, 602, 664, 25, 87, 149, 211, 273, 335, 397, 459, 521, 583, 645, 6, 68, 130, 192, 254, 316, 378, 440, 502, 564, 626, 688, 49, 111, 173, 235, 297, 359, 421, 483, 545, 607, 669, 30, 92, 154, 216, 278, 340, 402, 464, 526, 588, 650, 11, 73, 135, 197, 259, 321, 383, 445, 507, 569, 631, 693, 54, 116, 178, 240, 302, 364, 426, 488, 550, 612, 674, 35, 97, 159, 221, 283, 345, 407, 469, 531, 593, 655, 16, 78, 140, 202, 264, 326, 388, 450, 512, 574, 636, 698, 59, 121, 183, 245, 307, 369, 431, 493, 555, 617, 679, 40, 102, 164, 226, 288, 350, 412, 474, 536, 598, 660, 21, 83, 145, 207, 269, 331, 393, 455, 517, 579, 641, 2, 64, 126, 188, 250, 312, 374, 436, 498, 560, 622, 684, 45, 107, 169, 231, 293, 355, 417, 479, 541, 603, 665, 26, 88, 150, 212, 274, 336, 398, 460, 522, 584, 646, 7, 69, 131, 193, 255, 317, 379, 441, 503, 565, 627, 689, 50, 112, 174, 236, 298, 360, 422, 484, 546, 608, 670, 31, 93, 155, 217, 279, 341, 403, 465, 527, 589, 651, 12, 74, 136, 198, 260, 322, 384, 446, 508, 570, 632, 694, 55, 117, 179, 241, 303, 365, 427, 489, 551, 613, 675, 36, 98, 160, 222, 284, 346, 408, 470, 532, 594, 656, 17, 79, 141, 203, 265, 327, 389, 451, 513, 575, 637, 699, 60, 122, 184, 246, 308, 370, 432, 494, 556, 618, 680, 41, 103, 165, 227, 289, 351, 413, 475, 537, 599, 661, 22, 84, 146, 208, 270, 332, 394, 456, 518, 580, 642, 3, 65, 127, 189, 251, 313, 375, 437, 499, 561, 623, 685, 46, 108, 170, 232, 294, 356, 418, 480, 542, 604, 666, 27, 89, 151, 213, 275, 337, 399, 461, 523, 585, 647, 8, 70, 132, 194, 256, 318, 380, 442, 504, 566, 628, 690, 51, 113, 175, 237, 299, 361, 423, 485, 547, 609, 671, 32, 94, 156, 218, 280, 342, 404, 466, 528, 590, 652, 13, 75, 137, 199, 261, 323, 385, 447, 509, 571, 633, 695, 56, 118, 180, 242, 304, 366, 428, 490, 552, 614, 676, 37, 99, 161, 223, 285, 347, 409, 471, 533, 595, 657, 18, 80, 142, 204, 266, 328, 390, 452, 514, 576, 638, 700, 61, 123, 185, 247, 309, 371, 433, 495, 557, 619, 681, 42, 104, 166, 228, 290, 352, 414, 476, 538, 600, 662, 23, 85, 147, 209, 271, 333, 395, 457, 519, 581, 643, 4, 66, 128, 190, 252, 314, 376, 438, 500, 562, 624, 686, 47, 109, 171, 233, 295, 357, 419, 481, 543, 605, 667, 28, 90, 152, 214, 276, 338, 400, 462, 524, 586, 648, 9, 71, 133, 195, 257, 319, 381, 443, 505, 567, 629, 691, 52, 114, 176, 238, 300, 362, 424, 486, 548, 610, 672, 33, 95, 157, 219, 281, 343, 405, 467, 529, 591, 653, 14, 76, 138, 200, 262, 324, 386, 448, 510, 572, 634, 696, 57, 119, 181, 243, 305, 367, 429, 491, 553, 615, 677, 38, 100, 162, 224, 286, 348, 410, 472, 534, 596, 658, 19, 81, 143, 205, 267, 329, 391, 453, 515, 577, 639};



void cube_iter_1(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_1[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_3(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_3[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_6(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_6[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_12(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_12[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_15(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_15[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_42(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_42[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_84(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_84[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_168(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_168[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_336(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_336[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_27(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_27[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}

void square_iter_1(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_1[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_3(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_3[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_6(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_6[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_12(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_12[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_15(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_15[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_42(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_42[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_84(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_84[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_168(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_168[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_336(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_336[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_27(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_27[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}



void masked_inverse_s3(masked_poly* y, masked_poly* x){

  masked_poly a, b, c, d, e;
  masked_poly *y0, *y1, *y2, *y3, *y4, *y5, *y6, *y7, *y8, *y9, *y10, *y11, *y12;

  y0 = &c; 
  for(int i=0; i < N_SHARES; ++i) {
      cube_iter_1(&(x->shares[i]), &(a.shares[i]));
      for(int j=0; j < NTRU_N; ++j) (b.shares[i]).coeffs[j] = (a.shares[i]).coeffs[j];
  }
  poly_refresh(&a, 3);
  sec_S3_mul(&c, &a, &b);


  y1= &b; 
  for(int i=0; i < N_SHARES; ++i) cube_iter_1(&(y0->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y1, &a, y0);

  y2 = &d;
  for(int i=0; i < N_SHARES; ++i) cube_iter_1(&(y1->shares[i]), &(a.shares[i]));
  sec_S3_mul(y2, &a, y0);

  y3 = &c;
  for(int i=0; i < N_SHARES; ++i) cube_iter_3(&(y2->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y3, &a, y2);

  y4 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_6(&(y3->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y4, &a, y3);

  y5 = &e;
  for(int i=0; i < N_SHARES; ++i) cube_iter_3(&(y4->shares[i]), &(a.shares[i]));
  sec_S3_mul(y5, &a, y2);

  y6 = &c;
  for(int i=0; i < N_SHARES; ++i) cube_iter_12(&(y5->shares[i]), &(a.shares[i]));
  sec_S3_mul(y6, &a, y4);

  y7 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_15(&(y6->shares[i]), &(a.shares[i]));
  sec_S3_mul(y7, &a, y5);

  y8 = &d;
  for(int i=0; i < N_SHARES; ++i) cube_iter_42(&(y7->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y8, &a, y7);

  y9 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_84(&(y8->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y9, &a, y8);

  y10 = &d;
  for(int i=0; i < N_SHARES; ++i) cube_iter_168(&(y9->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y10, &a, y9);

  y11 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_336(&(y10->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y11, &a, y10);

  y12 = &d;
  for(int i=0; i < N_SHARES; ++i) cube_iter_27(&(y11->shares[i]), &(a.shares[i]));
  sec_S3_mul(y12, &a, y6);


  sec_S3_mul(y, y12, x);
}



void masked_inverse_s2(masked_poly* y, masked_poly* x){

  masked_poly a, b, c, d, e;
  masked_poly *y0, *y1, *y2, *y3, *y4, *y5, *y6, *y7, *y8, *y9, *y10, *y11, *y12;

  y0 = &c; 
  for(int i=0; i < N_SHARES; ++i) {
      for(int j=0; j < NTRU_N; ++j) (a.shares[i]).coeffs[j] = (x->shares[i]).coeffs[j];
      for(int j=0; j < NTRU_N; ++j) (b.shares[i]).coeffs[j] = (x->shares[i]).coeffs[j];
  }
  poly_refresh(&a, 2);
  sec_S2_mul(y0, &a, &b);

  y1= &b; 
  for(int i=0; i < N_SHARES; ++i) square_iter_1(&(y0->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y1, &a, y0);

  y2 = &d;
  for(int i=0; i < N_SHARES; ++i) square_iter_1(&(y1->shares[i]), &(a.shares[i]));
  sec_S2_mul(y2, &a, y0);

  y3 = &c;
  for(int i=0; i < N_SHARES; ++i) square_iter_3(&(y2->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y3, &a, y2);

  y4 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_6(&(y3->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y4, &a, y3);

  y5 = &e;
  for(int i=0; i < N_SHARES; ++i) square_iter_3(&(y4->shares[i]), &(a.shares[i]));
  sec_S2_mul(y5, &a, y2);

  y6 = &c;
  for(int i=0; i < N_SHARES; ++i) square_iter_12(&(y5->shares[i]), &(a.shares[i]));
  sec_S2_mul(y6, &a, y4);

  y7 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_15(&(y6->shares[i]), &(a.shares[i]));
  sec_S2_mul(y7, &a, y5);

  y8 = &d;
  for(int i=0; i < N_SHARES; ++i) square_iter_42(&(y7->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y8, &a, y7);

  y9 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_84(&(y8->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y9, &a, y8);

  y10 = &d;
  for(int i=0; i < N_SHARES; ++i) square_iter_168(&(y9->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y10, &a, y9);

  y11 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_336(&(y10->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y11, &a, y10);

  y12 = &d;
  for(int i=0; i < N_SHARES; ++i) square_iter_27(&(y11->shares[i]), &(a.shares[i]));
  sec_S2_mul(y, &a, y6);

}