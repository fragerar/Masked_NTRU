

uint16_t cube_shuffle_1[NTRU_N] = {0, 3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36, 39, 42, 45, 48, 51, 54, 57, 60, 63, 66, 69, 72, 75, 78, 81, 84, 87, 90, 93, 96, 99, 102, 105, 108, 111, 114, 117, 120, 123, 126, 129, 132, 135, 138, 141, 144, 147, 150, 153, 156, 159, 162, 165, 168, 171, 174, 177, 180, 183, 186, 189, 192, 195, 198, 201, 204, 207, 210, 213, 216, 219, 222, 225, 228, 231, 234, 237, 240, 243, 246, 249, 252, 255, 258, 261, 264, 267, 270, 273, 276, 279, 282, 285, 288, 291, 294, 297, 300, 303, 306, 309, 312, 315, 318, 321, 324, 327, 330, 333, 336, 339, 342, 345, 348, 351, 354, 357, 360, 363, 366, 369, 372, 375, 378, 381, 384, 387, 390, 393, 396, 399, 402, 405, 408, 411, 414, 417, 420, 423, 426, 429, 432, 435, 438, 441, 444, 447, 450, 453, 456, 459, 462, 465, 468, 471, 474, 477, 480, 483, 486, 489, 492, 495, 498, 501, 504, 507, 1, 4, 7, 10, 13, 16, 19, 22, 25, 28, 31, 34, 37, 40, 43, 46, 49, 52, 55, 58, 61, 64, 67, 70, 73, 76, 79, 82, 85, 88, 91, 94, 97, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 175, 178, 181, 184, 187, 190, 193, 196, 199, 202, 205, 208, 211, 214, 217, 220, 223, 226, 229, 232, 235, 238, 241, 244, 247, 250, 253, 256, 259, 262, 265, 268, 271, 274, 277, 280, 283, 286, 289, 292, 295, 298, 301, 304, 307, 310, 313, 316, 319, 322, 325, 328, 331, 334, 337, 340, 343, 346, 349, 352, 355, 358, 361, 364, 367, 370, 373, 376, 379, 382, 385, 388, 391, 394, 397, 400, 403, 406, 409, 412, 415, 418, 421, 424, 427, 430, 433, 436, 439, 442, 445, 448, 451, 454, 457, 460, 463, 466, 469, 472, 475, 478, 481, 484, 487, 490, 493, 496, 499, 502, 505, 508, 2, 5, 8, 11, 14, 17, 20, 23, 26, 29, 32, 35, 38, 41, 44, 47, 50, 53, 56, 59, 62, 65, 68, 71, 74, 77, 80, 83, 86, 89, 92, 95, 98, 101, 104, 107, 110, 113, 116, 119, 122, 125, 128, 131, 134, 137, 140, 143, 146, 149, 152, 155, 158, 161, 164, 167, 170, 173, 176, 179, 182, 185, 188, 191, 194, 197, 200, 203, 206, 209, 212, 215, 218, 221, 224, 227, 230, 233, 236, 239, 242, 245, 248, 251, 254, 257, 260, 263, 266, 269, 272, 275, 278, 281, 284, 287, 290, 293, 296, 299, 302, 305, 308, 311, 314, 317, 320, 323, 326, 329, 332, 335, 338, 341, 344, 347, 350, 353, 356, 359, 362, 365, 368, 371, 374, 377, 380, 383, 386, 389, 392, 395, 398, 401, 404, 407, 410, 413, 416, 419, 422, 425, 428, 431, 434, 437, 440, 443, 446, 449, 452, 455, 458, 461, 464, 467, 470, 473, 476, 479, 482, 485, 488, 491, 494, 497, 500, 503, 506 };
uint16_t cube_shuffle_3[NTRU_N] = {0, 27, 54, 81, 108, 135, 162, 189, 216, 243, 270, 297, 324, 351, 378, 405, 432, 459, 486, 4, 31, 58, 85, 112, 139, 166, 193, 220, 247, 274, 301, 328, 355, 382, 409, 436, 463, 490, 8, 35, 62, 89, 116, 143, 170, 197, 224, 251, 278, 305, 332, 359, 386, 413, 440, 467, 494, 12, 39, 66, 93, 120, 147, 174, 201, 228, 255, 282, 309, 336, 363, 390, 417, 444, 471, 498, 16, 43, 70, 97, 124, 151, 178, 205, 232, 259, 286, 313, 340, 367, 394, 421, 448, 475, 502, 20, 47, 74, 101, 128, 155, 182, 209, 236, 263, 290, 317, 344, 371, 398, 425, 452, 479, 506, 24, 51, 78, 105, 132, 159, 186, 213, 240, 267, 294, 321, 348, 375, 402, 429, 456, 483, 1, 28, 55, 82, 109, 136, 163, 190, 217, 244, 271, 298, 325, 352, 379, 406, 433, 460, 487, 5, 32, 59, 86, 113, 140, 167, 194, 221, 248, 275, 302, 329, 356, 383, 410, 437, 464, 491, 9, 36, 63, 90, 117, 144, 171, 198, 225, 252, 279, 306, 333, 360, 387, 414, 441, 468, 495, 13, 40, 67, 94, 121, 148, 175, 202, 229, 256, 283, 310, 337, 364, 391, 418, 445, 472, 499, 17, 44, 71, 98, 125, 152, 179, 206, 233, 260, 287, 314, 341, 368, 395, 422, 449, 476, 503, 21, 48, 75, 102, 129, 156, 183, 210, 237, 264, 291, 318, 345, 372, 399, 426, 453, 480, 507, 25, 52, 79, 106, 133, 160, 187, 214, 241, 268, 295, 322, 349, 376, 403, 430, 457, 484, 2, 29, 56, 83, 110, 137, 164, 191, 218, 245, 272, 299, 326, 353, 380, 407, 434, 461, 488, 6, 33, 60, 87, 114, 141, 168, 195, 222, 249, 276, 303, 330, 357, 384, 411, 438, 465, 492, 10, 37, 64, 91, 118, 145, 172, 199, 226, 253, 280, 307, 334, 361, 388, 415, 442, 469, 496, 14, 41, 68, 95, 122, 149, 176, 203, 230, 257, 284, 311, 338, 365, 392, 419, 446, 473, 500, 18, 45, 72, 99, 126, 153, 180, 207, 234, 261, 288, 315, 342, 369, 396, 423, 450, 477, 504, 22, 49, 76, 103, 130, 157, 184, 211, 238, 265, 292, 319, 346, 373, 400, 427, 454, 481, 508, 26, 53, 80, 107, 134, 161, 188, 215, 242, 269, 296, 323, 350, 377, 404, 431, 458, 485, 3, 30, 57, 84, 111, 138, 165, 192, 219, 246, 273, 300, 327, 354, 381, 408, 435, 462, 489, 7, 34, 61, 88, 115, 142, 169, 196, 223, 250, 277, 304, 331, 358, 385, 412, 439, 466, 493, 11, 38, 65, 92, 119, 146, 173, 200, 227, 254, 281, 308, 335, 362, 389, 416, 443, 470, 497, 15, 42, 69, 96, 123, 150, 177, 204, 231, 258, 285, 312, 339, 366, 393, 420, 447, 474, 501, 19, 46, 73, 100, 127, 154, 181, 208, 235, 262, 289, 316, 343, 370, 397, 424, 451, 478, 505, 23, 50, 77, 104, 131, 158, 185, 212, 239, 266, 293, 320, 347, 374, 401, 428, 455, 482 };
uint16_t cube_shuffle_6[NTRU_N] = {0, 220, 440, 151, 371, 82, 302, 13, 233, 453, 164, 384, 95, 315, 26, 246, 466, 177, 397, 108, 328, 39, 259, 479, 190, 410, 121, 341, 52, 272, 492, 203, 423, 134, 354, 65, 285, 505, 216, 436, 147, 367, 78, 298, 9, 229, 449, 160, 380, 91, 311, 22, 242, 462, 173, 393, 104, 324, 35, 255, 475, 186, 406, 117, 337, 48, 268, 488, 199, 419, 130, 350, 61, 281, 501, 212, 432, 143, 363, 74, 294, 5, 225, 445, 156, 376, 87, 307, 18, 238, 458, 169, 389, 100, 320, 31, 251, 471, 182, 402, 113, 333, 44, 264, 484, 195, 415, 126, 346, 57, 277, 497, 208, 428, 139, 359, 70, 290, 1, 221, 441, 152, 372, 83, 303, 14, 234, 454, 165, 385, 96, 316, 27, 247, 467, 178, 398, 109, 329, 40, 260, 480, 191, 411, 122, 342, 53, 273, 493, 204, 424, 135, 355, 66, 286, 506, 217, 437, 148, 368, 79, 299, 10, 230, 450, 161, 381, 92, 312, 23, 243, 463, 174, 394, 105, 325, 36, 256, 476, 187, 407, 118, 338, 49, 269, 489, 200, 420, 131, 351, 62, 282, 502, 213, 433, 144, 364, 75, 295, 6, 226, 446, 157, 377, 88, 308, 19, 239, 459, 170, 390, 101, 321, 32, 252, 472, 183, 403, 114, 334, 45, 265, 485, 196, 416, 127, 347, 58, 278, 498, 209, 429, 140, 360, 71, 291, 2, 222, 442, 153, 373, 84, 304, 15, 235, 455, 166, 386, 97, 317, 28, 248, 468, 179, 399, 110, 330, 41, 261, 481, 192, 412, 123, 343, 54, 274, 494, 205, 425, 136, 356, 67, 287, 507, 218, 438, 149, 369, 80, 300, 11, 231, 451, 162, 382, 93, 313, 24, 244, 464, 175, 395, 106, 326, 37, 257, 477, 188, 408, 119, 339, 50, 270, 490, 201, 421, 132, 352, 63, 283, 503, 214, 434, 145, 365, 76, 296, 7, 227, 447, 158, 378, 89, 309, 20, 240, 460, 171, 391, 102, 322, 33, 253, 473, 184, 404, 115, 335, 46, 266, 486, 197, 417, 128, 348, 59, 279, 499, 210, 430, 141, 361, 72, 292, 3, 223, 443, 154, 374, 85, 305, 16, 236, 456, 167, 387, 98, 318, 29, 249, 469, 180, 400, 111, 331, 42, 262, 482, 193, 413, 124, 344, 55, 275, 495, 206, 426, 137, 357, 68, 288, 508, 219, 439, 150, 370, 81, 301, 12, 232, 452, 163, 383, 94, 314, 25, 245, 465, 176, 396, 107, 327, 38, 258, 478, 189, 409, 120, 340, 51, 271, 491, 202, 422, 133, 353, 64, 284, 504, 215, 435, 146, 366, 77, 297, 8, 228, 448, 159, 379, 90, 310, 21, 241, 461, 172, 392, 103, 323, 34, 254, 474, 185, 405, 116, 336, 47, 267, 487, 198, 418, 129, 349, 60, 280, 500, 211, 431, 142, 362, 73, 293, 4, 224, 444, 155, 375, 86, 306, 17, 237, 457, 168, 388, 99, 319, 30, 250, 470, 181, 401, 112, 332, 43, 263, 483, 194, 414, 125, 345, 56, 276, 496, 207, 427, 138, 358, 69, 289 };
uint16_t cube_shuffle_15[NTRU_N] = {0, 197, 394, 82, 279, 476, 164, 361, 49, 246, 443, 131, 328, 16, 213, 410, 98, 295, 492, 180, 377, 65, 262, 459, 147, 344, 32, 229, 426, 114, 311, 508, 196, 393, 81, 278, 475, 163, 360, 48, 245, 442, 130, 327, 15, 212, 409, 97, 294, 491, 179, 376, 64, 261, 458, 146, 343, 31, 228, 425, 113, 310, 507, 195, 392, 80, 277, 474, 162, 359, 47, 244, 441, 129, 326, 14, 211, 408, 96, 293, 490, 178, 375, 63, 260, 457, 145, 342, 30, 227, 424, 112, 309, 506, 194, 391, 79, 276, 473, 161, 358, 46, 243, 440, 128, 325, 13, 210, 407, 95, 292, 489, 177, 374, 62, 259, 456, 144, 341, 29, 226, 423, 111, 308, 505, 193, 390, 78, 275, 472, 160, 357, 45, 242, 439, 127, 324, 12, 209, 406, 94, 291, 488, 176, 373, 61, 258, 455, 143, 340, 28, 225, 422, 110, 307, 504, 192, 389, 77, 274, 471, 159, 356, 44, 241, 438, 126, 323, 11, 208, 405, 93, 290, 487, 175, 372, 60, 257, 454, 142, 339, 27, 224, 421, 109, 306, 503, 191, 388, 76, 273, 470, 158, 355, 43, 240, 437, 125, 322, 10, 207, 404, 92, 289, 486, 174, 371, 59, 256, 453, 141, 338, 26, 223, 420, 108, 305, 502, 190, 387, 75, 272, 469, 157, 354, 42, 239, 436, 124, 321, 9, 206, 403, 91, 288, 485, 173, 370, 58, 255, 452, 140, 337, 25, 222, 419, 107, 304, 501, 189, 386, 74, 271, 468, 156, 353, 41, 238, 435, 123, 320, 8, 205, 402, 90, 287, 484, 172, 369, 57, 254, 451, 139, 336, 24, 221, 418, 106, 303, 500, 188, 385, 73, 270, 467, 155, 352, 40, 237, 434, 122, 319, 7, 204, 401, 89, 286, 483, 171, 368, 56, 253, 450, 138, 335, 23, 220, 417, 105, 302, 499, 187, 384, 72, 269, 466, 154, 351, 39, 236, 433, 121, 318, 6, 203, 400, 88, 285, 482, 170, 367, 55, 252, 449, 137, 334, 22, 219, 416, 104, 301, 498, 186, 383, 71, 268, 465, 153, 350, 38, 235, 432, 120, 317, 5, 202, 399, 87, 284, 481, 169, 366, 54, 251, 448, 136, 333, 21, 218, 415, 103, 300, 497, 185, 382, 70, 267, 464, 152, 349, 37, 234, 431, 119, 316, 4, 201, 398, 86, 283, 480, 168, 365, 53, 250, 447, 135, 332, 20, 217, 414, 102, 299, 496, 184, 381, 69, 266, 463, 151, 348, 36, 233, 430, 118, 315, 3, 200, 397, 85, 282, 479, 167, 364, 52, 249, 446, 134, 331, 19, 216, 413, 101, 298, 495, 183, 380, 68, 265, 462, 150, 347, 35, 232, 429, 117, 314, 2, 199, 396, 84, 281, 478, 166, 363, 51, 248, 445, 133, 330, 18, 215, 412, 100, 297, 494, 182, 379, 67, 264, 461, 149, 346, 34, 231, 428, 116, 313, 1, 198, 395, 83, 280, 477, 165, 362, 50, 247, 444, 132, 329, 17, 214, 411, 99, 296, 493, 181, 378, 66, 263, 460, 148, 345, 33, 230, 427, 115, 312 };
uint16_t cube_shuffle_30[NTRU_N] = {0, 125, 250, 375, 500, 116, 241, 366, 491, 107, 232, 357, 482, 98, 223, 348, 473, 89, 214, 339, 464, 80, 205, 330, 455, 71, 196, 321, 446, 62, 187, 312, 437, 53, 178, 303, 428, 44, 169, 294, 419, 35, 160, 285, 410, 26, 151, 276, 401, 17, 142, 267, 392, 8, 133, 258, 383, 508, 124, 249, 374, 499, 115, 240, 365, 490, 106, 231, 356, 481, 97, 222, 347, 472, 88, 213, 338, 463, 79, 204, 329, 454, 70, 195, 320, 445, 61, 186, 311, 436, 52, 177, 302, 427, 43, 168, 293, 418, 34, 159, 284, 409, 25, 150, 275, 400, 16, 141, 266, 391, 7, 132, 257, 382, 507, 123, 248, 373, 498, 114, 239, 364, 489, 105, 230, 355, 480, 96, 221, 346, 471, 87, 212, 337, 462, 78, 203, 328, 453, 69, 194, 319, 444, 60, 185, 310, 435, 51, 176, 301, 426, 42, 167, 292, 417, 33, 158, 283, 408, 24, 149, 274, 399, 15, 140, 265, 390, 6, 131, 256, 381, 506, 122, 247, 372, 497, 113, 238, 363, 488, 104, 229, 354, 479, 95, 220, 345, 470, 86, 211, 336, 461, 77, 202, 327, 452, 68, 193, 318, 443, 59, 184, 309, 434, 50, 175, 300, 425, 41, 166, 291, 416, 32, 157, 282, 407, 23, 148, 273, 398, 14, 139, 264, 389, 5, 130, 255, 380, 505, 121, 246, 371, 496, 112, 237, 362, 487, 103, 228, 353, 478, 94, 219, 344, 469, 85, 210, 335, 460, 76, 201, 326, 451, 67, 192, 317, 442, 58, 183, 308, 433, 49, 174, 299, 424, 40, 165, 290, 415, 31, 156, 281, 406, 22, 147, 272, 397, 13, 138, 263, 388, 4, 129, 254, 379, 504, 120, 245, 370, 495, 111, 236, 361, 486, 102, 227, 352, 477, 93, 218, 343, 468, 84, 209, 334, 459, 75, 200, 325, 450, 66, 191, 316, 441, 57, 182, 307, 432, 48, 173, 298, 423, 39, 164, 289, 414, 30, 155, 280, 405, 21, 146, 271, 396, 12, 137, 262, 387, 3, 128, 253, 378, 503, 119, 244, 369, 494, 110, 235, 360, 485, 101, 226, 351, 476, 92, 217, 342, 467, 83, 208, 333, 458, 74, 199, 324, 449, 65, 190, 315, 440, 56, 181, 306, 431, 47, 172, 297, 422, 38, 163, 288, 413, 29, 154, 279, 404, 20, 145, 270, 395, 11, 136, 261, 386, 2, 127, 252, 377, 502, 118, 243, 368, 493, 109, 234, 359, 484, 100, 225, 350, 475, 91, 216, 341, 466, 82, 207, 332, 457, 73, 198, 323, 448, 64, 189, 314, 439, 55, 180, 305, 430, 46, 171, 296, 421, 37, 162, 287, 412, 28, 153, 278, 403, 19, 144, 269, 394, 10, 135, 260, 385, 1, 126, 251, 376, 501, 117, 242, 367, 492, 108, 233, 358, 483, 99, 224, 349, 474, 90, 215, 340, 465, 81, 206, 331, 456, 72, 197, 322, 447, 63, 188, 313, 438, 54, 179, 304, 429, 45, 170, 295, 420, 36, 161, 286, 411, 27, 152, 277, 402, 18, 143, 268, 393, 9, 134, 259, 384 };
uint16_t cube_shuffle_63[NTRU_N] = {0, 423, 337, 251, 165, 79, 502, 416, 330, 244, 158, 72, 495, 409, 323, 237, 151, 65, 488, 402, 316, 230, 144, 58, 481, 395, 309, 223, 137, 51, 474, 388, 302, 216, 130, 44, 467, 381, 295, 209, 123, 37, 460, 374, 288, 202, 116, 30, 453, 367, 281, 195, 109, 23, 446, 360, 274, 188, 102, 16, 439, 353, 267, 181, 95, 9, 432, 346, 260, 174, 88, 2, 425, 339, 253, 167, 81, 504, 418, 332, 246, 160, 74, 497, 411, 325, 239, 153, 67, 490, 404, 318, 232, 146, 60, 483, 397, 311, 225, 139, 53, 476, 390, 304, 218, 132, 46, 469, 383, 297, 211, 125, 39, 462, 376, 290, 204, 118, 32, 455, 369, 283, 197, 111, 25, 448, 362, 276, 190, 104, 18, 441, 355, 269, 183, 97, 11, 434, 348, 262, 176, 90, 4, 427, 341, 255, 169, 83, 506, 420, 334, 248, 162, 76, 499, 413, 327, 241, 155, 69, 492, 406, 320, 234, 148, 62, 485, 399, 313, 227, 141, 55, 478, 392, 306, 220, 134, 48, 471, 385, 299, 213, 127, 41, 464, 378, 292, 206, 120, 34, 457, 371, 285, 199, 113, 27, 450, 364, 278, 192, 106, 20, 443, 357, 271, 185, 99, 13, 436, 350, 264, 178, 92, 6, 429, 343, 257, 171, 85, 508, 422, 336, 250, 164, 78, 501, 415, 329, 243, 157, 71, 494, 408, 322, 236, 150, 64, 487, 401, 315, 229, 143, 57, 480, 394, 308, 222, 136, 50, 473, 387, 301, 215, 129, 43, 466, 380, 294, 208, 122, 36, 459, 373, 287, 201, 115, 29, 452, 366, 280, 194, 108, 22, 445, 359, 273, 187, 101, 15, 438, 352, 266, 180, 94, 8, 431, 345, 259, 173, 87, 1, 424, 338, 252, 166, 80, 503, 417, 331, 245, 159, 73, 496, 410, 324, 238, 152, 66, 489, 403, 317, 231, 145, 59, 482, 396, 310, 224, 138, 52, 475, 389, 303, 217, 131, 45, 468, 382, 296, 210, 124, 38, 461, 375, 289, 203, 117, 31, 454, 368, 282, 196, 110, 24, 447, 361, 275, 189, 103, 17, 440, 354, 268, 182, 96, 10, 433, 347, 261, 175, 89, 3, 426, 340, 254, 168, 82, 505, 419, 333, 247, 161, 75, 498, 412, 326, 240, 154, 68, 491, 405, 319, 233, 147, 61, 484, 398, 312, 226, 140, 54, 477, 391, 305, 219, 133, 47, 470, 384, 298, 212, 126, 40, 463, 377, 291, 205, 119, 33, 456, 370, 284, 198, 112, 26, 449, 363, 277, 191, 105, 19, 442, 356, 270, 184, 98, 12, 435, 349, 263, 177, 91, 5, 428, 342, 256, 170, 84, 507, 421, 335, 249, 163, 77, 500, 414, 328, 242, 156, 70, 493, 407, 321, 235, 149, 63, 486, 400, 314, 228, 142, 56, 479, 393, 307, 221, 135, 49, 472, 386, 300, 214, 128, 42, 465, 379, 293, 207, 121, 35, 458, 372, 286, 200, 114, 28, 451, 365, 279, 193, 107, 21, 444, 358, 272, 186, 100, 14, 437, 351, 265, 179, 93, 7, 430, 344, 258, 172, 86 };
uint16_t cube_shuffle_126[NTRU_N] = {0, 270, 31, 301, 62, 332, 93, 363, 124, 394, 155, 425, 186, 456, 217, 487, 248, 9, 279, 40, 310, 71, 341, 102, 372, 133, 403, 164, 434, 195, 465, 226, 496, 257, 18, 288, 49, 319, 80, 350, 111, 381, 142, 412, 173, 443, 204, 474, 235, 505, 266, 27, 297, 58, 328, 89, 359, 120, 390, 151, 421, 182, 452, 213, 483, 244, 5, 275, 36, 306, 67, 337, 98, 368, 129, 399, 160, 430, 191, 461, 222, 492, 253, 14, 284, 45, 315, 76, 346, 107, 377, 138, 408, 169, 439, 200, 470, 231, 501, 262, 23, 293, 54, 324, 85, 355, 116, 386, 147, 417, 178, 448, 209, 479, 240, 1, 271, 32, 302, 63, 333, 94, 364, 125, 395, 156, 426, 187, 457, 218, 488, 249, 10, 280, 41, 311, 72, 342, 103, 373, 134, 404, 165, 435, 196, 466, 227, 497, 258, 19, 289, 50, 320, 81, 351, 112, 382, 143, 413, 174, 444, 205, 475, 236, 506, 267, 28, 298, 59, 329, 90, 360, 121, 391, 152, 422, 183, 453, 214, 484, 245, 6, 276, 37, 307, 68, 338, 99, 369, 130, 400, 161, 431, 192, 462, 223, 493, 254, 15, 285, 46, 316, 77, 347, 108, 378, 139, 409, 170, 440, 201, 471, 232, 502, 263, 24, 294, 55, 325, 86, 356, 117, 387, 148, 418, 179, 449, 210, 480, 241, 2, 272, 33, 303, 64, 334, 95, 365, 126, 396, 157, 427, 188, 458, 219, 489, 250, 11, 281, 42, 312, 73, 343, 104, 374, 135, 405, 166, 436, 197, 467, 228, 498, 259, 20, 290, 51, 321, 82, 352, 113, 383, 144, 414, 175, 445, 206, 476, 237, 507, 268, 29, 299, 60, 330, 91, 361, 122, 392, 153, 423, 184, 454, 215, 485, 246, 7, 277, 38, 308, 69, 339, 100, 370, 131, 401, 162, 432, 193, 463, 224, 494, 255, 16, 286, 47, 317, 78, 348, 109, 379, 140, 410, 171, 441, 202, 472, 233, 503, 264, 25, 295, 56, 326, 87, 357, 118, 388, 149, 419, 180, 450, 211, 481, 242, 3, 273, 34, 304, 65, 335, 96, 366, 127, 397, 158, 428, 189, 459, 220, 490, 251, 12, 282, 43, 313, 74, 344, 105, 375, 136, 406, 167, 437, 198, 468, 229, 499, 260, 21, 291, 52, 322, 83, 353, 114, 384, 145, 415, 176, 446, 207, 477, 238, 508, 269, 30, 300, 61, 331, 92, 362, 123, 393, 154, 424, 185, 455, 216, 486, 247, 8, 278, 39, 309, 70, 340, 101, 371, 132, 402, 163, 433, 194, 464, 225, 495, 256, 17, 287, 48, 318, 79, 349, 110, 380, 141, 411, 172, 442, 203, 473, 234, 504, 265, 26, 296, 57, 327, 88, 358, 119, 389, 150, 420, 181, 451, 212, 482, 243, 4, 274, 35, 305, 66, 336, 97, 367, 128, 398, 159, 429, 190, 460, 221, 491, 252, 13, 283, 44, 314, 75, 345, 106, 376, 137, 407, 168, 438, 199, 469, 230, 500, 261, 22, 292, 53, 323, 84, 354, 115, 385, 146, 416, 177, 447, 208, 478, 239 };
uint16_t cube_shuffle_252[NTRU_N] = {0, 113, 226, 339, 452, 56, 169, 282, 395, 508, 112, 225, 338, 451, 55, 168, 281, 394, 507, 111, 224, 337, 450, 54, 167, 280, 393, 506, 110, 223, 336, 449, 53, 166, 279, 392, 505, 109, 222, 335, 448, 52, 165, 278, 391, 504, 108, 221, 334, 447, 51, 164, 277, 390, 503, 107, 220, 333, 446, 50, 163, 276, 389, 502, 106, 219, 332, 445, 49, 162, 275, 388, 501, 105, 218, 331, 444, 48, 161, 274, 387, 500, 104, 217, 330, 443, 47, 160, 273, 386, 499, 103, 216, 329, 442, 46, 159, 272, 385, 498, 102, 215, 328, 441, 45, 158, 271, 384, 497, 101, 214, 327, 440, 44, 157, 270, 383, 496, 100, 213, 326, 439, 43, 156, 269, 382, 495, 99, 212, 325, 438, 42, 155, 268, 381, 494, 98, 211, 324, 437, 41, 154, 267, 380, 493, 97, 210, 323, 436, 40, 153, 266, 379, 492, 96, 209, 322, 435, 39, 152, 265, 378, 491, 95, 208, 321, 434, 38, 151, 264, 377, 490, 94, 207, 320, 433, 37, 150, 263, 376, 489, 93, 206, 319, 432, 36, 149, 262, 375, 488, 92, 205, 318, 431, 35, 148, 261, 374, 487, 91, 204, 317, 430, 34, 147, 260, 373, 486, 90, 203, 316, 429, 33, 146, 259, 372, 485, 89, 202, 315, 428, 32, 145, 258, 371, 484, 88, 201, 314, 427, 31, 144, 257, 370, 483, 87, 200, 313, 426, 30, 143, 256, 369, 482, 86, 199, 312, 425, 29, 142, 255, 368, 481, 85, 198, 311, 424, 28, 141, 254, 367, 480, 84, 197, 310, 423, 27, 140, 253, 366, 479, 83, 196, 309, 422, 26, 139, 252, 365, 478, 82, 195, 308, 421, 25, 138, 251, 364, 477, 81, 194, 307, 420, 24, 137, 250, 363, 476, 80, 193, 306, 419, 23, 136, 249, 362, 475, 79, 192, 305, 418, 22, 135, 248, 361, 474, 78, 191, 304, 417, 21, 134, 247, 360, 473, 77, 190, 303, 416, 20, 133, 246, 359, 472, 76, 189, 302, 415, 19, 132, 245, 358, 471, 75, 188, 301, 414, 18, 131, 244, 357, 470, 74, 187, 300, 413, 17, 130, 243, 356, 469, 73, 186, 299, 412, 16, 129, 242, 355, 468, 72, 185, 298, 411, 15, 128, 241, 354, 467, 71, 184, 297, 410, 14, 127, 240, 353, 466, 70, 183, 296, 409, 13, 126, 239, 352, 465, 69, 182, 295, 408, 12, 125, 238, 351, 464, 68, 181, 294, 407, 11, 124, 237, 350, 463, 67, 180, 293, 406, 10, 123, 236, 349, 462, 66, 179, 292, 405, 9, 122, 235, 348, 461, 65, 178, 291, 404, 8, 121, 234, 347, 460, 64, 177, 290, 403, 7, 120, 233, 346, 459, 63, 176, 289, 402, 6, 119, 232, 345, 458, 62, 175, 288, 401, 5, 118, 231, 344, 457, 61, 174, 287, 400, 4, 117, 230, 343, 456, 60, 173, 286, 399, 3, 116, 229, 342, 455, 59, 172, 285, 398, 2, 115, 228, 341, 454, 58, 171, 284, 397, 1, 114, 227, 340, 453, 57, 170, 283, 396 };

uint16_t square_shuffle_1[NTRU_N] = {0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400, 402, 404, 406, 408, 410, 412, 414, 416, 418, 420, 422, 424, 426, 428, 430, 432, 434, 436, 438, 440, 442, 444, 446, 448, 450, 452, 454, 456, 458, 460, 462, 464, 466, 468, 470, 472, 474, 476, 478, 480, 482, 484, 486, 488, 490, 492, 494, 496, 498, 500, 502, 504, 506, 508, 1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 61, 63, 65, 67, 69, 71, 73, 75, 77, 79, 81, 83, 85, 87, 89, 91, 93, 95, 97, 99, 101, 103, 105, 107, 109, 111, 113, 115, 117, 119, 121, 123, 125, 127, 129, 131, 133, 135, 137, 139, 141, 143, 145, 147, 149, 151, 153, 155, 157, 159, 161, 163, 165, 167, 169, 171, 173, 175, 177, 179, 181, 183, 185, 187, 189, 191, 193, 195, 197, 199, 201, 203, 205, 207, 209, 211, 213, 215, 217, 219, 221, 223, 225, 227, 229, 231, 233, 235, 237, 239, 241, 243, 245, 247, 249, 251, 253, 255, 257, 259, 261, 263, 265, 267, 269, 271, 273, 275, 277, 279, 281, 283, 285, 287, 289, 291, 293, 295, 297, 299, 301, 303, 305, 307, 309, 311, 313, 315, 317, 319, 321, 323, 325, 327, 329, 331, 333, 335, 337, 339, 341, 343, 345, 347, 349, 351, 353, 355, 357, 359, 361, 363, 365, 367, 369, 371, 373, 375, 377, 379, 381, 383, 385, 387, 389, 391, 393, 395, 397, 399, 401, 403, 405, 407, 409, 411, 413, 415, 417, 419, 421, 423, 425, 427, 429, 431, 433, 435, 437, 439, 441, 443, 445, 447, 449, 451, 453, 455, 457, 459, 461, 463, 465, 467, 469, 471, 473, 475, 477, 479, 481, 483, 485, 487, 489, 491, 493, 495, 497, 499, 501, 503, 505, 507 };
uint16_t square_shuffle_3[NTRU_N] = {0, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 3, 11, 19, 27, 35, 43, 51, 59, 67, 75, 83, 91, 99, 107, 115, 123, 131, 139, 147, 155, 163, 171, 179, 187, 195, 203, 211, 219, 227, 235, 243, 251, 259, 267, 275, 283, 291, 299, 307, 315, 323, 331, 339, 347, 355, 363, 371, 379, 387, 395, 403, 411, 419, 427, 435, 443, 451, 459, 467, 475, 483, 491, 499, 507, 6, 14, 22, 30, 38, 46, 54, 62, 70, 78, 86, 94, 102, 110, 118, 126, 134, 142, 150, 158, 166, 174, 182, 190, 198, 206, 214, 222, 230, 238, 246, 254, 262, 270, 278, 286, 294, 302, 310, 318, 326, 334, 342, 350, 358, 366, 374, 382, 390, 398, 406, 414, 422, 430, 438, 446, 454, 462, 470, 478, 486, 494, 502, 1, 9, 17, 25, 33, 41, 49, 57, 65, 73, 81, 89, 97, 105, 113, 121, 129, 137, 145, 153, 161, 169, 177, 185, 193, 201, 209, 217, 225, 233, 241, 249, 257, 265, 273, 281, 289, 297, 305, 313, 321, 329, 337, 345, 353, 361, 369, 377, 385, 393, 401, 409, 417, 425, 433, 441, 449, 457, 465, 473, 481, 489, 497, 505, 4, 12, 20, 28, 36, 44, 52, 60, 68, 76, 84, 92, 100, 108, 116, 124, 132, 140, 148, 156, 164, 172, 180, 188, 196, 204, 212, 220, 228, 236, 244, 252, 260, 268, 276, 284, 292, 300, 308, 316, 324, 332, 340, 348, 356, 364, 372, 380, 388, 396, 404, 412, 420, 428, 436, 444, 452, 460, 468, 476, 484, 492, 500, 508, 7, 15, 23, 31, 39, 47, 55, 63, 71, 79, 87, 95, 103, 111, 119, 127, 135, 143, 151, 159, 167, 175, 183, 191, 199, 207, 215, 223, 231, 239, 247, 255, 263, 271, 279, 287, 295, 303, 311, 319, 327, 335, 343, 351, 359, 367, 375, 383, 391, 399, 407, 415, 423, 431, 439, 447, 455, 463, 471, 479, 487, 495, 503, 2, 10, 18, 26, 34, 42, 50, 58, 66, 74, 82, 90, 98, 106, 114, 122, 130, 138, 146, 154, 162, 170, 178, 186, 194, 202, 210, 218, 226, 234, 242, 250, 258, 266, 274, 282, 290, 298, 306, 314, 322, 330, 338, 346, 354, 362, 370, 378, 386, 394, 402, 410, 418, 426, 434, 442, 450, 458, 466, 474, 482, 490, 498, 506, 5, 13, 21, 29, 37, 45, 53, 61, 69, 77, 85, 93, 101, 109, 117, 125, 133, 141, 149, 157, 165, 173, 181, 189, 197, 205, 213, 221, 229, 237, 245, 253, 261, 269, 277, 285, 293, 301, 309, 317, 325, 333, 341, 349, 357, 365, 373, 381, 389, 397, 405, 413, 421, 429, 437, 445, 453, 461, 469, 477, 485, 493, 501 };
uint16_t square_shuffle_6[NTRU_N] = {0, 64, 128, 192, 256, 320, 384, 448, 3, 67, 131, 195, 259, 323, 387, 451, 6, 70, 134, 198, 262, 326, 390, 454, 9, 73, 137, 201, 265, 329, 393, 457, 12, 76, 140, 204, 268, 332, 396, 460, 15, 79, 143, 207, 271, 335, 399, 463, 18, 82, 146, 210, 274, 338, 402, 466, 21, 85, 149, 213, 277, 341, 405, 469, 24, 88, 152, 216, 280, 344, 408, 472, 27, 91, 155, 219, 283, 347, 411, 475, 30, 94, 158, 222, 286, 350, 414, 478, 33, 97, 161, 225, 289, 353, 417, 481, 36, 100, 164, 228, 292, 356, 420, 484, 39, 103, 167, 231, 295, 359, 423, 487, 42, 106, 170, 234, 298, 362, 426, 490, 45, 109, 173, 237, 301, 365, 429, 493, 48, 112, 176, 240, 304, 368, 432, 496, 51, 115, 179, 243, 307, 371, 435, 499, 54, 118, 182, 246, 310, 374, 438, 502, 57, 121, 185, 249, 313, 377, 441, 505, 60, 124, 188, 252, 316, 380, 444, 508, 63, 127, 191, 255, 319, 383, 447, 2, 66, 130, 194, 258, 322, 386, 450, 5, 69, 133, 197, 261, 325, 389, 453, 8, 72, 136, 200, 264, 328, 392, 456, 11, 75, 139, 203, 267, 331, 395, 459, 14, 78, 142, 206, 270, 334, 398, 462, 17, 81, 145, 209, 273, 337, 401, 465, 20, 84, 148, 212, 276, 340, 404, 468, 23, 87, 151, 215, 279, 343, 407, 471, 26, 90, 154, 218, 282, 346, 410, 474, 29, 93, 157, 221, 285, 349, 413, 477, 32, 96, 160, 224, 288, 352, 416, 480, 35, 99, 163, 227, 291, 355, 419, 483, 38, 102, 166, 230, 294, 358, 422, 486, 41, 105, 169, 233, 297, 361, 425, 489, 44, 108, 172, 236, 300, 364, 428, 492, 47, 111, 175, 239, 303, 367, 431, 495, 50, 114, 178, 242, 306, 370, 434, 498, 53, 117, 181, 245, 309, 373, 437, 501, 56, 120, 184, 248, 312, 376, 440, 504, 59, 123, 187, 251, 315, 379, 443, 507, 62, 126, 190, 254, 318, 382, 446, 1, 65, 129, 193, 257, 321, 385, 449, 4, 68, 132, 196, 260, 324, 388, 452, 7, 71, 135, 199, 263, 327, 391, 455, 10, 74, 138, 202, 266, 330, 394, 458, 13, 77, 141, 205, 269, 333, 397, 461, 16, 80, 144, 208, 272, 336, 400, 464, 19, 83, 147, 211, 275, 339, 403, 467, 22, 86, 150, 214, 278, 342, 406, 470, 25, 89, 153, 217, 281, 345, 409, 473, 28, 92, 156, 220, 284, 348, 412, 476, 31, 95, 159, 223, 287, 351, 415, 479, 34, 98, 162, 226, 290, 354, 418, 482, 37, 101, 165, 229, 293, 357, 421, 485, 40, 104, 168, 232, 296, 360, 424, 488, 43, 107, 171, 235, 299, 363, 427, 491, 46, 110, 174, 238, 302, 366, 430, 494, 49, 113, 177, 241, 305, 369, 433, 497, 52, 116, 180, 244, 308, 372, 436, 500, 55, 119, 183, 247, 311, 375, 439, 503, 58, 122, 186, 250, 314, 378, 442, 506, 61, 125, 189, 253, 317, 381, 445 };
uint16_t square_shuffle_15[NTRU_N] = {0, 192, 384, 67, 259, 451, 134, 326, 9, 201, 393, 76, 268, 460, 143, 335, 18, 210, 402, 85, 277, 469, 152, 344, 27, 219, 411, 94, 286, 478, 161, 353, 36, 228, 420, 103, 295, 487, 170, 362, 45, 237, 429, 112, 304, 496, 179, 371, 54, 246, 438, 121, 313, 505, 188, 380, 63, 255, 447, 130, 322, 5, 197, 389, 72, 264, 456, 139, 331, 14, 206, 398, 81, 273, 465, 148, 340, 23, 215, 407, 90, 282, 474, 157, 349, 32, 224, 416, 99, 291, 483, 166, 358, 41, 233, 425, 108, 300, 492, 175, 367, 50, 242, 434, 117, 309, 501, 184, 376, 59, 251, 443, 126, 318, 1, 193, 385, 68, 260, 452, 135, 327, 10, 202, 394, 77, 269, 461, 144, 336, 19, 211, 403, 86, 278, 470, 153, 345, 28, 220, 412, 95, 287, 479, 162, 354, 37, 229, 421, 104, 296, 488, 171, 363, 46, 238, 430, 113, 305, 497, 180, 372, 55, 247, 439, 122, 314, 506, 189, 381, 64, 256, 448, 131, 323, 6, 198, 390, 73, 265, 457, 140, 332, 15, 207, 399, 82, 274, 466, 149, 341, 24, 216, 408, 91, 283, 475, 158, 350, 33, 225, 417, 100, 292, 484, 167, 359, 42, 234, 426, 109, 301, 493, 176, 368, 51, 243, 435, 118, 310, 502, 185, 377, 60, 252, 444, 127, 319, 2, 194, 386, 69, 261, 453, 136, 328, 11, 203, 395, 78, 270, 462, 145, 337, 20, 212, 404, 87, 279, 471, 154, 346, 29, 221, 413, 96, 288, 480, 163, 355, 38, 230, 422, 105, 297, 489, 172, 364, 47, 239, 431, 114, 306, 498, 181, 373, 56, 248, 440, 123, 315, 507, 190, 382, 65, 257, 449, 132, 324, 7, 199, 391, 74, 266, 458, 141, 333, 16, 208, 400, 83, 275, 467, 150, 342, 25, 217, 409, 92, 284, 476, 159, 351, 34, 226, 418, 101, 293, 485, 168, 360, 43, 235, 427, 110, 302, 494, 177, 369, 52, 244, 436, 119, 311, 503, 186, 378, 61, 253, 445, 128, 320, 3, 195, 387, 70, 262, 454, 137, 329, 12, 204, 396, 79, 271, 463, 146, 338, 21, 213, 405, 88, 280, 472, 155, 347, 30, 222, 414, 97, 289, 481, 164, 356, 39, 231, 423, 106, 298, 490, 173, 365, 48, 240, 432, 115, 307, 499, 182, 374, 57, 249, 441, 124, 316, 508, 191, 383, 66, 258, 450, 133, 325, 8, 200, 392, 75, 267, 459, 142, 334, 17, 209, 401, 84, 276, 468, 151, 343, 26, 218, 410, 93, 285, 477, 160, 352, 35, 227, 419, 102, 294, 486, 169, 361, 44, 236, 428, 111, 303, 495, 178, 370, 53, 245, 437, 120, 312, 504, 187, 379, 62, 254, 446, 129, 321, 4, 196, 388, 71, 263, 455, 138, 330, 13, 205, 397, 80, 272, 464, 147, 339, 22, 214, 406, 89, 281, 473, 156, 348, 31, 223, 415, 98, 290, 482, 165, 357, 40, 232, 424, 107, 299, 491, 174, 366, 49, 241, 433, 116, 308, 500, 183, 375, 58, 250, 442, 125, 317 };
uint16_t square_shuffle_30[NTRU_N] = {0, 216, 432, 139, 355, 62, 278, 494, 201, 417, 124, 340, 47, 263, 479, 186, 402, 109, 325, 32, 248, 464, 171, 387, 94, 310, 17, 233, 449, 156, 372, 79, 295, 2, 218, 434, 141, 357, 64, 280, 496, 203, 419, 126, 342, 49, 265, 481, 188, 404, 111, 327, 34, 250, 466, 173, 389, 96, 312, 19, 235, 451, 158, 374, 81, 297, 4, 220, 436, 143, 359, 66, 282, 498, 205, 421, 128, 344, 51, 267, 483, 190, 406, 113, 329, 36, 252, 468, 175, 391, 98, 314, 21, 237, 453, 160, 376, 83, 299, 6, 222, 438, 145, 361, 68, 284, 500, 207, 423, 130, 346, 53, 269, 485, 192, 408, 115, 331, 38, 254, 470, 177, 393, 100, 316, 23, 239, 455, 162, 378, 85, 301, 8, 224, 440, 147, 363, 70, 286, 502, 209, 425, 132, 348, 55, 271, 487, 194, 410, 117, 333, 40, 256, 472, 179, 395, 102, 318, 25, 241, 457, 164, 380, 87, 303, 10, 226, 442, 149, 365, 72, 288, 504, 211, 427, 134, 350, 57, 273, 489, 196, 412, 119, 335, 42, 258, 474, 181, 397, 104, 320, 27, 243, 459, 166, 382, 89, 305, 12, 228, 444, 151, 367, 74, 290, 506, 213, 429, 136, 352, 59, 275, 491, 198, 414, 121, 337, 44, 260, 476, 183, 399, 106, 322, 29, 245, 461, 168, 384, 91, 307, 14, 230, 446, 153, 369, 76, 292, 508, 215, 431, 138, 354, 61, 277, 493, 200, 416, 123, 339, 46, 262, 478, 185, 401, 108, 324, 31, 247, 463, 170, 386, 93, 309, 16, 232, 448, 155, 371, 78, 294, 1, 217, 433, 140, 356, 63, 279, 495, 202, 418, 125, 341, 48, 264, 480, 187, 403, 110, 326, 33, 249, 465, 172, 388, 95, 311, 18, 234, 450, 157, 373, 80, 296, 3, 219, 435, 142, 358, 65, 281, 497, 204, 420, 127, 343, 50, 266, 482, 189, 405, 112, 328, 35, 251, 467, 174, 390, 97, 313, 20, 236, 452, 159, 375, 82, 298, 5, 221, 437, 144, 360, 67, 283, 499, 206, 422, 129, 345, 52, 268, 484, 191, 407, 114, 330, 37, 253, 469, 176, 392, 99, 315, 22, 238, 454, 161, 377, 84, 300, 7, 223, 439, 146, 362, 69, 285, 501, 208, 424, 131, 347, 54, 270, 486, 193, 409, 116, 332, 39, 255, 471, 178, 394, 101, 317, 24, 240, 456, 163, 379, 86, 302, 9, 225, 441, 148, 364, 71, 287, 503, 210, 426, 133, 349, 56, 272, 488, 195, 411, 118, 334, 41, 257, 473, 180, 396, 103, 319, 26, 242, 458, 165, 381, 88, 304, 11, 227, 443, 150, 366, 73, 289, 505, 212, 428, 135, 351, 58, 274, 490, 197, 413, 120, 336, 43, 259, 475, 182, 398, 105, 321, 28, 244, 460, 167, 383, 90, 306, 13, 229, 445, 152, 368, 75, 291, 507, 214, 430, 137, 353, 60, 276, 492, 199, 415, 122, 338, 45, 261, 477, 184, 400, 107, 323, 30, 246, 462, 169, 385, 92, 308, 15, 231, 447, 154, 370, 77, 293 };
uint16_t square_shuffle_63[NTRU_N] = {0, 151, 302, 453, 95, 246, 397, 39, 190, 341, 492, 134, 285, 436, 78, 229, 380, 22, 173, 324, 475, 117, 268, 419, 61, 212, 363, 5, 156, 307, 458, 100, 251, 402, 44, 195, 346, 497, 139, 290, 441, 83, 234, 385, 27, 178, 329, 480, 122, 273, 424, 66, 217, 368, 10, 161, 312, 463, 105, 256, 407, 49, 200, 351, 502, 144, 295, 446, 88, 239, 390, 32, 183, 334, 485, 127, 278, 429, 71, 222, 373, 15, 166, 317, 468, 110, 261, 412, 54, 205, 356, 507, 149, 300, 451, 93, 244, 395, 37, 188, 339, 490, 132, 283, 434, 76, 227, 378, 20, 171, 322, 473, 115, 266, 417, 59, 210, 361, 3, 154, 305, 456, 98, 249, 400, 42, 193, 344, 495, 137, 288, 439, 81, 232, 383, 25, 176, 327, 478, 120, 271, 422, 64, 215, 366, 8, 159, 310, 461, 103, 254, 405, 47, 198, 349, 500, 142, 293, 444, 86, 237, 388, 30, 181, 332, 483, 125, 276, 427, 69, 220, 371, 13, 164, 315, 466, 108, 259, 410, 52, 203, 354, 505, 147, 298, 449, 91, 242, 393, 35, 186, 337, 488, 130, 281, 432, 74, 225, 376, 18, 169, 320, 471, 113, 264, 415, 57, 208, 359, 1, 152, 303, 454, 96, 247, 398, 40, 191, 342, 493, 135, 286, 437, 79, 230, 381, 23, 174, 325, 476, 118, 269, 420, 62, 213, 364, 6, 157, 308, 459, 101, 252, 403, 45, 196, 347, 498, 140, 291, 442, 84, 235, 386, 28, 179, 330, 481, 123, 274, 425, 67, 218, 369, 11, 162, 313, 464, 106, 257, 408, 50, 201, 352, 503, 145, 296, 447, 89, 240, 391, 33, 184, 335, 486, 128, 279, 430, 72, 223, 374, 16, 167, 318, 469, 111, 262, 413, 55, 206, 357, 508, 150, 301, 452, 94, 245, 396, 38, 189, 340, 491, 133, 284, 435, 77, 228, 379, 21, 172, 323, 474, 116, 267, 418, 60, 211, 362, 4, 155, 306, 457, 99, 250, 401, 43, 194, 345, 496, 138, 289, 440, 82, 233, 384, 26, 177, 328, 479, 121, 272, 423, 65, 216, 367, 9, 160, 311, 462, 104, 255, 406, 48, 199, 350, 501, 143, 294, 445, 87, 238, 389, 31, 182, 333, 484, 126, 277, 428, 70, 221, 372, 14, 165, 316, 467, 109, 260, 411, 53, 204, 355, 506, 148, 299, 450, 92, 243, 394, 36, 187, 338, 489, 131, 282, 433, 75, 226, 377, 19, 170, 321, 472, 114, 265, 416, 58, 209, 360, 2, 153, 304, 455, 97, 248, 399, 41, 192, 343, 494, 136, 287, 438, 80, 231, 382, 24, 175, 326, 477, 119, 270, 421, 63, 214, 365, 7, 158, 309, 460, 102, 253, 404, 46, 197, 348, 499, 141, 292, 443, 85, 236, 387, 29, 180, 331, 482, 124, 275, 426, 68, 219, 370, 12, 163, 314, 465, 107, 258, 409, 51, 202, 353, 504, 146, 297, 448, 90, 241, 392, 34, 185, 336, 487, 129, 280, 431, 73, 224, 375, 17, 168, 319, 470, 112, 263, 414, 56, 207, 358 };
uint16_t square_shuffle_126[NTRU_N] = {0, 405, 301, 197, 93, 498, 394, 290, 186, 82, 487, 383, 279, 175, 71, 476, 372, 268, 164, 60, 465, 361, 257, 153, 49, 454, 350, 246, 142, 38, 443, 339, 235, 131, 27, 432, 328, 224, 120, 16, 421, 317, 213, 109, 5, 410, 306, 202, 98, 503, 399, 295, 191, 87, 492, 388, 284, 180, 76, 481, 377, 273, 169, 65, 470, 366, 262, 158, 54, 459, 355, 251, 147, 43, 448, 344, 240, 136, 32, 437, 333, 229, 125, 21, 426, 322, 218, 114, 10, 415, 311, 207, 103, 508, 404, 300, 196, 92, 497, 393, 289, 185, 81, 486, 382, 278, 174, 70, 475, 371, 267, 163, 59, 464, 360, 256, 152, 48, 453, 349, 245, 141, 37, 442, 338, 234, 130, 26, 431, 327, 223, 119, 15, 420, 316, 212, 108, 4, 409, 305, 201, 97, 502, 398, 294, 190, 86, 491, 387, 283, 179, 75, 480, 376, 272, 168, 64, 469, 365, 261, 157, 53, 458, 354, 250, 146, 42, 447, 343, 239, 135, 31, 436, 332, 228, 124, 20, 425, 321, 217, 113, 9, 414, 310, 206, 102, 507, 403, 299, 195, 91, 496, 392, 288, 184, 80, 485, 381, 277, 173, 69, 474, 370, 266, 162, 58, 463, 359, 255, 151, 47, 452, 348, 244, 140, 36, 441, 337, 233, 129, 25, 430, 326, 222, 118, 14, 419, 315, 211, 107, 3, 408, 304, 200, 96, 501, 397, 293, 189, 85, 490, 386, 282, 178, 74, 479, 375, 271, 167, 63, 468, 364, 260, 156, 52, 457, 353, 249, 145, 41, 446, 342, 238, 134, 30, 435, 331, 227, 123, 19, 424, 320, 216, 112, 8, 413, 309, 205, 101, 506, 402, 298, 194, 90, 495, 391, 287, 183, 79, 484, 380, 276, 172, 68, 473, 369, 265, 161, 57, 462, 358, 254, 150, 46, 451, 347, 243, 139, 35, 440, 336, 232, 128, 24, 429, 325, 221, 117, 13, 418, 314, 210, 106, 2, 407, 303, 199, 95, 500, 396, 292, 188, 84, 489, 385, 281, 177, 73, 478, 374, 270, 166, 62, 467, 363, 259, 155, 51, 456, 352, 248, 144, 40, 445, 341, 237, 133, 29, 434, 330, 226, 122, 18, 423, 319, 215, 111, 7, 412, 308, 204, 100, 505, 401, 297, 193, 89, 494, 390, 286, 182, 78, 483, 379, 275, 171, 67, 472, 368, 264, 160, 56, 461, 357, 253, 149, 45, 450, 346, 242, 138, 34, 439, 335, 231, 127, 23, 428, 324, 220, 116, 12, 417, 313, 209, 105, 1, 406, 302, 198, 94, 499, 395, 291, 187, 83, 488, 384, 280, 176, 72, 477, 373, 269, 165, 61, 466, 362, 258, 154, 50, 455, 351, 247, 143, 39, 444, 340, 236, 132, 28, 433, 329, 225, 121, 17, 422, 318, 214, 110, 6, 411, 307, 203, 99, 504, 400, 296, 192, 88, 493, 389, 285, 181, 77, 482, 378, 274, 170, 66, 471, 367, 263, 159, 55, 460, 356, 252, 148, 44, 449, 345, 241, 137, 33, 438, 334, 230, 126, 22, 427, 323, 219, 115, 11, 416, 312, 208, 104 };
uint16_t square_shuffle_252[NTRU_N] = {0, 127, 254, 381, 508, 126, 253, 380, 507, 125, 252, 379, 506, 124, 251, 378, 505, 123, 250, 377, 504, 122, 249, 376, 503, 121, 248, 375, 502, 120, 247, 374, 501, 119, 246, 373, 500, 118, 245, 372, 499, 117, 244, 371, 498, 116, 243, 370, 497, 115, 242, 369, 496, 114, 241, 368, 495, 113, 240, 367, 494, 112, 239, 366, 493, 111, 238, 365, 492, 110, 237, 364, 491, 109, 236, 363, 490, 108, 235, 362, 489, 107, 234, 361, 488, 106, 233, 360, 487, 105, 232, 359, 486, 104, 231, 358, 485, 103, 230, 357, 484, 102, 229, 356, 483, 101, 228, 355, 482, 100, 227, 354, 481, 99, 226, 353, 480, 98, 225, 352, 479, 97, 224, 351, 478, 96, 223, 350, 477, 95, 222, 349, 476, 94, 221, 348, 475, 93, 220, 347, 474, 92, 219, 346, 473, 91, 218, 345, 472, 90, 217, 344, 471, 89, 216, 343, 470, 88, 215, 342, 469, 87, 214, 341, 468, 86, 213, 340, 467, 85, 212, 339, 466, 84, 211, 338, 465, 83, 210, 337, 464, 82, 209, 336, 463, 81, 208, 335, 462, 80, 207, 334, 461, 79, 206, 333, 460, 78, 205, 332, 459, 77, 204, 331, 458, 76, 203, 330, 457, 75, 202, 329, 456, 74, 201, 328, 455, 73, 200, 327, 454, 72, 199, 326, 453, 71, 198, 325, 452, 70, 197, 324, 451, 69, 196, 323, 450, 68, 195, 322, 449, 67, 194, 321, 448, 66, 193, 320, 447, 65, 192, 319, 446, 64, 191, 318, 445, 63, 190, 317, 444, 62, 189, 316, 443, 61, 188, 315, 442, 60, 187, 314, 441, 59, 186, 313, 440, 58, 185, 312, 439, 57, 184, 311, 438, 56, 183, 310, 437, 55, 182, 309, 436, 54, 181, 308, 435, 53, 180, 307, 434, 52, 179, 306, 433, 51, 178, 305, 432, 50, 177, 304, 431, 49, 176, 303, 430, 48, 175, 302, 429, 47, 174, 301, 428, 46, 173, 300, 427, 45, 172, 299, 426, 44, 171, 298, 425, 43, 170, 297, 424, 42, 169, 296, 423, 41, 168, 295, 422, 40, 167, 294, 421, 39, 166, 293, 420, 38, 165, 292, 419, 37, 164, 291, 418, 36, 163, 290, 417, 35, 162, 289, 416, 34, 161, 288, 415, 33, 160, 287, 414, 32, 159, 286, 413, 31, 158, 285, 412, 30, 157, 284, 411, 29, 156, 283, 410, 28, 155, 282, 409, 27, 154, 281, 408, 26, 153, 280, 407, 25, 152, 279, 406, 24, 151, 278, 405, 23, 150, 277, 404, 22, 149, 276, 403, 21, 148, 275, 402, 20, 147, 274, 401, 19, 146, 273, 400, 18, 145, 272, 399, 17, 144, 271, 398, 16, 143, 270, 397, 15, 142, 269, 396, 14, 141, 268, 395, 13, 140, 267, 394, 12, 139, 266, 393, 11, 138, 265, 392, 10, 137, 264, 391, 9, 136, 263, 390, 8, 135, 262, 389, 7, 134, 261, 388, 6, 133, 260, 387, 5, 132, 259, 386, 4, 131, 258, 385, 3, 130, 257, 384, 2, 129, 256, 383, 1, 128, 255, 382};




void cube_iter_1(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_1[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_3(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_3[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_6(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_6[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_15(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_15[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_30(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_30[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_63(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_63[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_126(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_126[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}
void cube_iter_252(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[cube_shuffle_252[i]] = x->coeffs[i];
  poly_mod_3_Phi_n(y);
}


void square_iter_1(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_1[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_3(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_3[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_6(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_6[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_15(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_15[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_30(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_30[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_63(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_63[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_126(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_126[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}
void square_iter_252(poly* x, poly* y){
  for(int i=0; i < NTRU_N; ++i) y->coeffs[square_shuffle_252[i]] = x->coeffs[i];
  poly_mod_2_Phi_n(y);
}



void masked_inverse_s3(masked_poly* y, masked_poly* x){


  masked_poly a, b, c, d, e;
  masked_poly *y0, *y1, *y2, *y3, *y4, *y5, *y6, *y7, *y8, *y9, *y10, *y11, *y12;

  y0 = &c; 
  for(int i=0; i < N_SHARES; ++i) {
      cube_iter_1(&(x->shares[i]), &(a.shares[i]));
      for(int j=0; j < NTRU_N; ++j) (b.shares[i]).coeffs[j] = (a.shares[i]).coeffs[j];
  }
  poly_refresh(&a, 3);
  sec_S3_mul(&c, &a, &b);

  y1= &b; 
  for(int i=0; i < N_SHARES; ++i) cube_iter_1(&(y0->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y1, &a, y0);

  y2 = &d;
  for(int i=0; i < N_SHARES; ++i) cube_iter_1(&(y1->shares[i]), &(a.shares[i]));
  sec_S3_mul(y2, &a, y0);

  y3 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_3(&(y2->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y3, &a, y2);

  y4 = &c;
  for(int i=0; i < N_SHARES; ++i) cube_iter_6(&(y3->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y4, &a, y3);

  y5 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_3(&(y4->shares[i]), &(a.shares[i]));
  sec_S3_mul(y5, &a, y2);

  y6 = &c;
  for(int i=0; i < N_SHARES; ++i) cube_iter_15(&(y5->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y6, &a, y5);

  y7 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_30(&(y6->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y7, &a, y6);

  y8 = &c;
  for(int i=0; i < N_SHARES; ++i) cube_iter_3(&(y7->shares[i]), &(a.shares[i]));
  sec_S3_mul(y8, &a, y2);

  y9 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_63(&(y8->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y9, &a, y8);
  
  y10 = &c;
  for(int i=0; i < N_SHARES; ++i) cube_iter_126(&(y9->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y10, &a, y9);

  y11 = &b;
  for(int i=0; i < N_SHARES; ++i) cube_iter_252(&(y10->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 3);
  sec_S3_mul(y11, &a, y10);

  y12 = &c;
  for(int i=0; i < N_SHARES; ++i) cube_iter_3(&(y11->shares[i]), &(a.shares[i]));
  sec_S3_mul(y12, &a, y2);

  sec_S3_mul(y, y12, x);
}


void masked_inverse_s2(masked_poly* y, masked_poly* x){

  masked_poly a, b, c, d, e;
  masked_poly *y0, *y1, *y2, *y3, *y4, *y5, *y6, *y7, *y8, *y9, *y10, *y11, *y12;

  y0 = &c; 
  for(int i=0; i < N_SHARES; ++i) {
      for(int j=0; j < NTRU_N; ++j) (a.shares[i]).coeffs[j] = (x->shares[i]).coeffs[j];
      for(int j=0; j < NTRU_N; ++j) (b.shares[i]).coeffs[j] = (x->shares[i]).coeffs[j];
  }
  poly_refresh(&a, 2);
  sec_S2_mul(y0, &a, &b);

  y1= &b; 
  for(int i=0; i < N_SHARES; ++i) square_iter_1(&(y0->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y1, &a, y0);

  y2 = &d;
  for(int i=0; i < N_SHARES; ++i) square_iter_1(&(y1->shares[i]), &(a.shares[i]));
  sec_S2_mul(y2, &a, y0);

  y3 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_3(&(y2->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y3, &a, y2);

  y4 = &c;
  for(int i=0; i < N_SHARES; ++i) square_iter_6(&(y3->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y4, &a, y3);

  y5 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_3(&(y4->shares[i]), &(a.shares[i]));
  sec_S2_mul(y5, &a, y2);

  y6 = &c;
  for(int i=0; i < N_SHARES; ++i) square_iter_15(&(y5->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y6, &a, y5);

  y7 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_30(&(y6->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y7, &a, y6);

  y8 = &c;
  for(int i=0; i < N_SHARES; ++i) square_iter_3(&(y7->shares[i]), &(a.shares[i]));
  sec_S2_mul(y8, &a, y2);

  y9 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_63(&(y8->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y9, &a, y8);
  
  y10 = &c;
  for(int i=0; i < N_SHARES; ++i) square_iter_126(&(y9->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y10, &a, y9);

  y11 = &b;
  for(int i=0; i < N_SHARES; ++i) square_iter_252(&(y10->shares[i]), &(a.shares[i]));
  poly_refresh(&a, 2);
  sec_S2_mul(y11, &a, y10);

  y12 = &c;
  for(int i=0; i < N_SHARES; ++i) square_iter_3(&(y11->shares[i]), &(a.shares[i]));
  sec_S2_mul(y, &a, y2);

}

